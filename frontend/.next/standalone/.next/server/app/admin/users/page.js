(()=>{var e={};e.id=9674,e.ids=[9674],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},39097:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>r.Z,__next_app__:()=>c,originalPathname:()=>x,pages:()=>d,routeModule:()=>u,tree:()=>o}),s(89049),s(95478),s(26083),s(96560);var a=s(23191),l=s(88716),r=s(48001),n=s(95231),i={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>n[e]);s.d(t,i);let o=["",{children:["admin",{children:["users",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,89049)),"/root/Loyalty/frontend/app/admin/users/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,95478)),"/root/Loyalty/frontend/app/layout.tsx"],error:[()=>Promise.resolve().then(s.bind(s,26083)),"/root/Loyalty/frontend/app/error.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,96560)),"/root/Loyalty/frontend/app/not-found.tsx"]}],d=["/root/Loyalty/frontend/app/admin/users/page.tsx"],x="/admin/users/page",c={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/admin/users/page",pathname:"/admin/users",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},55904:(e,t,s)=>{Promise.resolve().then(s.bind(s,38457))},38457:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var a=s(10326),l=s(17577),r=s(35047),n=s(36143);s(6824);var i=s(96633),o=s(941),d=s(88307),x=s(76557);let c=(0,x.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var u=s(40765);let p=(0,x.Z)("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);var m=s(39183),h=s(55358),b=s.n(h);function g(){let e=(0,r.useRouter)(),[t,s]=(0,l.useState)([]),[x,h]=(0,l.useState)(""),[g,v]=(0,l.useState)(!0),[f,j]=(0,l.useState)(1),[y,w]=(0,l.useState)(25),[N,_]=(0,l.useState)("all"),[k,C]=(0,l.useState)("all"),[S,q]=(0,l.useState)("all"),[L,T]=(0,l.useState)("all"),[P,Z]=(0,l.useState)("all"),[$,D]=(0,l.useState)("joined"),[A,M]=(0,l.useState)("desc"),[z,E]=(0,l.useState)([]),[I,O]=(0,l.useState)(!1),[G,R]=(0,l.useState)(!1),[V,B]=(0,l.useState)(!1),[H,U]=(0,l.useState)(!1),[X,J]=(0,l.useState)(!1),[Y,F]=(0,l.useState)([]),[K,Q]=(0,l.useState)({customer:0,staff:0,investor:0,media:0,total:0}),W=(0,l.useMemo)(()=>{let e=[...t];if("all"!==N&&(e=e.filter(e=>{let t=e.user_type||"customer";return("employee"===t?"staff":t)===N})),"all"!==k&&(e=e.filter(e=>"active"===k?!1!==e.is_active:"inactive"!==k||!1===e.is_active)),"all"!==S&&(e=e.filter(e=>e.company===S)),"all"!==L){let t=new Date;e=e.filter(e=>{if(!e.created_at)return!1;let s=new Date(e.created_at),a=(t.getTime()-s.getTime())/864e5;return"last7days"===L?a<=7:"last30days"===L?a<=30:"last90days"!==L||a<=90})}if("all"!==P){let t=new Date;e=e.filter(e=>{let s=e.investor_expiry_date||e.media_expiry_date;if(!s)return!1;let a=(new Date(s).getTime()-t.getTime())/864e5;return"last7days"===P?a>=0&&a<=7:"last30days"===P?a>=0&&a<=30:"last90days"!==P||a>=0&&a<=90})}if(x){let t=x.toLowerCase();e=e.filter(e=>e.name?.toLowerCase().includes(t)||e.surname?.toLowerCase().includes(t)||e.email?.toLowerCase().includes(t)||e.phone?.toLowerCase().includes(t)||e.company?.toLowerCase().includes(t)||e.id?.toString().includes(t))}return e.sort((e,t)=>{let s,a;switch($){case"name":s=`${e.name} ${e.surname}`.toLowerCase(),a=`${t.name} ${t.surname}`.toLowerCase();break;case"balance":s=e.points_balance||0,a=t.points_balance||0;break;case"spent":s=e.total_spend||0,a=t.total_spend||0;break;case"joined":s=new Date(e.created_at||0).getTime(),a=new Date(t.created_at||0).getTime();break;case"lastVisit":s=new Date(e.last_visit||0).getTime(),a=new Date(t.last_visit||0).getTime();break;default:return 0}return s<a?"asc"===A?-1:1:s>a?"asc"===A?1:-1:0}),e},[t,x,N,k,S,L,P,$,A]),ee=(0,l.useMemo)(()=>{let e=(f-1)*y;return W.slice(e,e+y)},[W,f,y]),et=Math.ceil(W.length/y),es=e=>{E(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},ea=e=>{$===e?M("asc"===A?"desc":"asc"):(D(e),M("desc"))},el={customer:{label:"Customer",count:K.customer},staff:{label:"Staff",count:K.staff},investor:{label:"Investor",count:K.investor},media:{label:"Media",count:K.media}},er=({field:e})=>$!==e?a.jsx(i.Z,{size:14,className:"opacity-0 group-hover:opacity-30"}):"asc"===A?a.jsx(i.Z,{size:14}):a.jsx(o.Z,{size:14}),en=({label:e,value:t,options:s,isOpen:l,onToggle:r,onChange:n,width:i="w-[140px]"})=>{let d=s.find(e=>e.value===t);return(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-[10px] font-semibold uppercase tracking-tight text-neutral-500 mb-1.5",children:e}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:r,className:`h-[40px] px-3 rounded-lg border border-neutral-300 bg-white text-[14px] text-neutral-900 hover:border-neutral-400 transition-all flex items-center justify-between gap-2 ${i}`,children:[a.jsx("span",{className:"truncate",children:d?.label||"Select..."}),a.jsx(o.Z,{size:14,className:"text-neutral-500 flex-shrink-0"})]}),l&&(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-10",onClick:r}),a.jsx("div",{className:"absolute left-0 top-full mt-1 bg-white border border-neutral-200 rounded-lg shadow-lg py-1 z-20 min-w-full max-h-64 overflow-y-auto",children:s.map(e=>a.jsx("button",{onClick:()=>{n(e.value),r()},className:`w-full text-left px-3 py-2 text-[14px] transition-colors ${t===e.value?"bg-neutral-100 text-neutral-900 font-medium":"text-neutral-700 hover:bg-neutral-50"}`,children:e.label},e.value))})]})]})]})};return a.jsx(n.Z,{children:a.jsx("div",{className:"min-h-screen bg-neutral-50",children:(0,a.jsxs)("div",{className:"max-w-[1600px] mx-auto px-6 py-8",children:[(0,a.jsxs)("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-[28px] font-semibold text-neutral-900",children:"Users"}),(0,a.jsxs)("p",{className:"text-[14px] text-neutral-500 mt-1",children:[K.total," total users"]})]}),a.jsx("div",{className:"bg-white border border-neutral-200 rounded-xl p-4 mb-6 shadow-sm",children:(0,a.jsxs)("div",{className:"flex items-end justify-between gap-4 flex-wrap",children:[(0,a.jsxs)("div",{className:"flex items-end gap-4 flex-1",children:[(0,a.jsxs)("div",{className:"relative",children:[a.jsx(d.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-neutral-400"}),a.jsx("input",{type:"text",className:"w-[320px] h-[40px] pl-10 pr-3 border border-neutral-300 rounded-lg text-[14px] text-neutral-900 placeholder:text-neutral-400 focus:outline-none focus:ring-2 focus:ring-neutral-900 focus:border-transparent bg-white",placeholder:"Search...",value:x,onChange:e=>h(e.target.value)})]}),a.jsx(en,{label:"TYPE",value:N,options:[{value:"all",label:"All Types"},{value:"customer",label:`Customers (${K.customer})`},{value:"staff",label:`Staff (${K.staff})`},{value:"investor",label:`Investors (${K.investor})`},{value:"media",label:`Media (${K.media})`}],isOpen:I,onToggle:()=>O(!I),onChange:e=>_(e),width:"w-[140px]"}),a.jsx(en,{label:"STATUS",value:k,options:[{value:"all",label:"All"},{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}],isOpen:G,onToggle:()=>R(!G),onChange:e=>C(e),width:"w-[120px]"}),a.jsx(en,{label:"COMPANY",value:S,options:[{value:"all",label:"All Companies"},...Y.map(e=>({value:e,label:e}))],isOpen:V,onToggle:()=>B(!V),onChange:e=>q(e),width:"w-[160px]"}),a.jsx(en,{label:"JOINED",value:L,options:[{value:"all",label:"All"},{value:"last7days",label:"Last 7 days"},{value:"last30days",label:"Last 30 days"},{value:"last90days",label:"Last 90 days"}],isOpen:H,onToggle:()=>U(!H),onChange:e=>T(e),width:"w-[130px]"}),a.jsx(en,{label:"EXPIRES IN",value:P,options:[{value:"all",label:"All"},{value:"last7days",label:"Next 7 days"},{value:"last30days",label:"Next 30 days"},{value:"last90days",label:"Next 90 days"}],isOpen:X,onToggle:()=>J(!X),onChange:e=>Z(e),width:"w-[130px]"})]}),(0,a.jsxs)("button",{onClick:()=>{b().success("Export feature coming soon")},className:"h-[40px] px-4 rounded-lg border border-neutral-300 bg-white text-neutral-900 hover:bg-neutral-50 text-[14px] font-medium transition-all flex items-center gap-2",children:[a.jsx(c,{size:16}),"Export"]})]})}),(0,a.jsxs)("div",{className:"bg-white border border-neutral-200 rounded-xl shadow-sm overflow-hidden",children:[z.length>0&&a.jsx("div",{className:"bg-neutral-900 text-white px-6 py-4 border-b border-neutral-800",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-[14px] font-medium",children:[z.length," user",z.length>1?"s":""," selected"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{className:"h-[36px] px-3 rounded-lg bg-white/10 hover:bg-white/20 text-[14px] font-medium transition-all flex items-center gap-2",children:[a.jsx(u.Z,{size:16}),"Add Tags"]}),(0,a.jsxs)("button",{className:"h-[36px] px-3 rounded-lg bg-white/10 hover:bg-white/20 text-[14px] font-medium transition-all flex items-center gap-2",children:[a.jsx(p,{size:16}),"Disable"]}),a.jsx("button",{onClick:()=>E([]),className:"h-[36px] px-3 rounded-lg bg-white/10 hover:bg-white/20 text-[14px] font-medium transition-all",children:"Clear"})]})]})}),(0,a.jsxs)("div",{className:"flex items-center h-[48px] px-4 border-b border-neutral-200 bg-neutral-50 text-[11px] font-semibold uppercase tracking-wider text-neutral-600",children:[a.jsx("div",{className:"w-10 flex items-center",children:a.jsx("input",{type:"checkbox",checked:z.length===ee.length&&ee.length>0,onChange:()=>{z.length===ee.length?E([]):E(ee.map(e=>e.id))},className:"w-4 h-4 rounded border-neutral-300 text-neutral-900 focus:ring-neutral-900 cursor-pointer"})}),a.jsx("div",{className:"w-[80px] px-4",children:"ID"}),(0,a.jsxs)("button",{onClick:()=>ea("name"),className:"flex-1 px-4 flex items-center gap-1 hover:text-neutral-900 transition-colors group text-left",children:["Name",a.jsx(er,{field:"name"})]}),a.jsx("div",{className:"w-[100px] px-4",children:"Type"}),a.jsx("div",{className:"w-[160px] px-4",children:"Contact"}),a.jsx("div",{className:"w-[100px] px-4",children:"Status"}),(0,a.jsxs)("button",{onClick:()=>ea("balance"),className:"w-[120px] px-4 text-right flex items-center justify-end gap-1 hover:text-neutral-900 transition-colors group",children:["Balance",a.jsx(er,{field:"balance"})]}),(0,a.jsxs)("button",{onClick:()=>ea("spent"),className:"w-[120px] px-4 text-right flex items-center justify-end gap-1 hover:text-neutral-900 transition-colors group",children:["Spent",a.jsx(er,{field:"spent"})]}),(0,a.jsxs)("button",{onClick:()=>ea("joined"),className:"w-[130px] px-4 flex items-center gap-1 hover:text-neutral-900 transition-colors group",children:["Joined",a.jsx(er,{field:"joined"})]}),(0,a.jsxs)("button",{onClick:()=>ea("lastVisit"),className:"w-[130px] px-4 flex items-center gap-1 hover:text-neutral-900 transition-colors group",children:["Last Visit",a.jsx(er,{field:"lastVisit"})]}),a.jsx("div",{className:"w-10"})]}),g?a.jsx("div",{className:"flex items-center justify-center h-40 text-[14px] text-neutral-500",children:"Loading users..."}):0===ee.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 px-4",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-neutral-100 flex items-center justify-center mb-4",children:a.jsx(d.Z,{size:24,className:"text-neutral-400"})}),a.jsx("h3",{className:"text-[16px] font-semibold text-neutral-900 mb-1",children:"No users found"}),a.jsx("p",{className:"text-[14px] text-neutral-500",children:"Try adjusting your filters."})]}):ee.map(t=>{let s=z.includes(t.id),l="employee"===t.user_type?"staff":t.user_type||"customer",r=el[l];return(0,a.jsxs)("div",{className:`flex items-center h-[60px] px-4 border-b border-neutral-100 last:border-0 hover:bg-neutral-50 cursor-pointer transition-colors ${s?"bg-neutral-100":""}`,onClick:()=>e.push(`/admin/users/${t.id}`),children:[a.jsx("div",{className:"w-10 flex items-center",onClick:e=>e.stopPropagation(),children:a.jsx("input",{type:"checkbox",checked:s,onChange:()=>es(t.id),className:"w-4 h-4 rounded border-neutral-300 text-neutral-900 focus:ring-neutral-900 cursor-pointer"})}),a.jsx("div",{className:"w-[80px] px-4",children:(0,a.jsxs)("span",{className:"text-[13px] font-mono text-neutral-500",children:["#",t.id]})}),(0,a.jsxs)("div",{className:"flex-1 px-4 min-w-0",children:[(0,a.jsxs)("p",{className:"text-[14px] font-medium text-neutral-900 truncate",children:[t.name," ",t.surname]}),t.company&&a.jsx("p",{className:"text-[13px] text-neutral-500 truncate",children:t.company})]}),a.jsx("div",{className:"w-[100px] px-4",children:a.jsx("span",{className:"inline-flex items-center h-[24px] px-2 rounded-md bg-neutral-100 text-[12px] font-medium text-neutral-700",children:r.label})}),(0,a.jsxs)("div",{className:"w-[160px] px-4",children:[a.jsx("p",{className:"text-[13px] text-neutral-900",children:t.phone}),t.email&&a.jsx("p",{className:"text-[12px] text-neutral-500 truncate",children:t.email})]}),a.jsx("div",{className:"w-[100px] px-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`w-1 h-1 rounded-full ${!1!==t.is_active?"bg-green-500":"bg-neutral-300"}`}),a.jsx("span",{className:"text-[13px] font-medium text-neutral-700",children:!1!==t.is_active?"Active":"Inactive"})]})}),a.jsx("div",{className:"w-[120px] px-4 text-right font-mono text-[14px] font-medium text-neutral-900",children:"investor"===l?`฿${(t.investor_group_credits_balance||0).toLocaleString()}`:"media"===l?`฿${((t.media_annual_budget_thb||0)-(t.media_spent_this_year_thb||0)).toLocaleString()}`:`${t.points_balance||0} pts`}),(0,a.jsxs)("div",{className:"w-[120px] px-4 text-right font-mono text-[14px] font-medium text-neutral-900",children:["฿",t.total_spend?Number(t.total_spend).toLocaleString():"0"]}),a.jsx("div",{className:"w-[130px] px-4 text-[13px] text-neutral-600",children:t.created_at?new Date(t.created_at).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}):"—"}),a.jsx("div",{className:"w-[130px] px-4 text-[13px] text-neutral-400",children:t.last_visit?new Date(t.last_visit).toLocaleDateString("en-GB",{day:"numeric",month:"short"}):"Never"}),a.jsx("div",{className:"w-10 flex justify-end",children:a.jsx(m.Z,{size:16,className:"text-neutral-400"})})]},t.id)}),!g&&ee.length>0&&(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-t border-neutral-200 bg-white",children:[(0,a.jsxs)("p",{className:"text-[14px] text-neutral-600",children:["Showing ",(f-1)*y+1,"–",Math.min(f*y,W.length)," of ",W.length]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:()=>j(f-1),disabled:1===f,className:"h-[32px] px-3 border border-neutral-300 rounded-lg text-[13px] font-medium text-neutral-700 hover:bg-neutral-50 disabled:opacity-40 disabled:cursor-not-allowed transition-colors bg-white",children:"Previous"}),Array.from({length:Math.min(5,et)},(e,t)=>{let s;return s=et<=5?t+1:f<=3?t+1:f>=et-2?et-4+t:f-2+t,a.jsx("button",{onClick:()=>j(s),className:`h-[32px] w-[32px] rounded-lg text-[13px] font-medium transition-all ${f===s?"bg-neutral-900 text-white":"border border-neutral-300 hover:bg-neutral-50 text-neutral-700 bg-white"}`,children:s},s)}),a.jsx("button",{onClick:()=>j(f+1),disabled:f===et,className:"h-[32px] px-3 border border-neutral-300 rounded-lg text-[13px] font-medium text-neutral-700 hover:bg-neutral-50 disabled:opacity-40 disabled:cursor-not-allowed transition-colors bg-white",children:"Next"})]})]})]})]})})})}},39183:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(76557).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},88307:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(76557).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},40765:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(76557).Z)("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]])},89049:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(68570).createProxy)(String.raw`/root/Loyalty/frontend/app/admin/users/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[5380,2696,4464,5814,9538],()=>s(39097));module.exports=a})();