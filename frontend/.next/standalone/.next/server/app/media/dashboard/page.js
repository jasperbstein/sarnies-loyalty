(()=>{var e={};e.id=6468,e.ids=[6468],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},16050:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.Z,__next_app__:()=>x,originalPathname:()=>c,pages:()=>o,routeModule:()=>g,tree:()=>d}),s(15419),s(95478),s(26083),s(96560);var a=s(23191),r=s(88716),i=s(48001),n=s(95231),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);s.d(t,l);let d=["",{children:["media",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,15419)),"/root/Loyalty/frontend/app/media/dashboard/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,95478)),"/root/Loyalty/frontend/app/layout.tsx"],error:[()=>Promise.resolve().then(s.bind(s,26083)),"/root/Loyalty/frontend/app/error.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,96560)),"/root/Loyalty/frontend/app/not-found.tsx"]}],o=["/root/Loyalty/frontend/app/media/dashboard/page.tsx"],c="/media/dashboard/page",x={require:s,loadChunk:()=>Promise.resolve()},g=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/media/dashboard/page",pathname:"/media/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},73948:(e,t,s)=>{Promise.resolve().then(s.bind(s,80773))},80773:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var a=s(10326),r=s(17577);s(6824);var i=s(71821);let n=(0,s(76557).Z)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);var l=s(66697),d=s(37358);function o(){let[e,t]=(0,r.useState)(null),[s,o]=(0,r.useState)([]),[c,x]=(0,r.useState)(!0),g=e=>{let t=new Date;return Math.ceil((new Date(e).getTime()-t.getTime())/864e5)};if(c)return a.jsx("div",{className:"min-h-screen bg-gray-50 p-8",children:a.jsx("div",{className:"max-w-6xl mx-auto",children:(0,a.jsxs)("div",{className:"animate-pulse space-y-4",children:[a.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),a.jsx("div",{className:"h-64 bg-gray-200 rounded"})]})})});let m=e&&0!==e.annual_budget?e.budget_spent/e.annual_budget*100:0;return a.jsx("div",{className:"min-h-screen bg-gray-50 p-8",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Media Dashboard"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Track your annual budget and spending"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Annual Budget"}),a.jsx(i.Z,{className:"text-blue-600",size:20})]}),(0,a.jsxs)("p",{className:"text-3xl font-bold text-gray-900",children:["฿",(e?.annual_budget||0).toLocaleString()]}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Total allocation"})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Spent"}),a.jsx(n,{className:"text-red-600",size:20})]}),(0,a.jsxs)("p",{className:"text-3xl font-bold text-red-600",children:["฿",(e?.budget_spent||0).toLocaleString()]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[m.toFixed(1),"% used"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Remaining"}),a.jsx(l.Z,{className:"text-green-600",size:20})]}),(0,a.jsxs)("p",{className:"text-3xl font-bold text-green-600",children:["฿",(e?.budget_remaining||0).toLocaleString()]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[(100-m).toFixed(1),"% left"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Expires In"}),a.jsx(d.Z,{className:"text-purple-600",size:20})]}),a.jsx("p",{className:"text-3xl font-bold text-gray-900",children:e?.expires_at?g(e.expires_at):0}),a.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Days remaining"})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Budget Usage"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm mb-2",children:[a.jsx("span",{className:"text-gray-600",children:"Budget Utilization"}),(0,a.jsxs)("span",{className:"font-medium text-gray-900",children:[m.toFixed(1),"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4",children:a.jsx("div",{className:`h-4 rounded-full transition-all duration-300 ${m<50?"bg-green-500":m<80?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(m,100)}%`}})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4 mt-6",children:[(0,a.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Annual Budget"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-blue-600",children:["฿",(e?.annual_budget||0).toLocaleString()]})]}),(0,a.jsxs)("div",{className:"p-4 bg-red-50 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Total Spent"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-red-600",children:["฿",(e?.budget_spent||0).toLocaleString()]})]}),(0,a.jsxs)("div",{className:"p-4 bg-green-50 rounded-lg",children:[a.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Remaining"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:["฿",(e?.budget_remaining||0).toLocaleString()]})]})]}),e?.expires_at&&a.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Budget Expires"}),a.jsx("p",{className:"text-lg font-semibold text-gray-900",children:new Date(e.expires_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),(0,a.jsxs)("div",{className:"text-right",children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Days Remaining"}),a.jsx("p",{className:`text-3xl font-bold ${g(e.expires_at)>90?"text-green-600":g(e.expires_at)>30?"text-yellow-600":"text-red-600"}`,children:g(e.expires_at)})]})]})})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Recent Transactions"}),s.length>0?a.jsx("div",{className:"space-y-2",children:s.map(e=>(0,a.jsxs)("div",{className:"flex justify-between items-center py-3 px-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium text-gray-900",children:e.description}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[new Date(e.created_at).toLocaleString(),e.outlet_name&&` • ${e.outlet_name}`]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:`text-lg font-bold ${"allocation"===e.type?"text-green-600":"text-red-600"}`,children:["allocation"===e.type?"+":"-","฿",Math.abs(e.amount).toLocaleString()]}),a.jsx("p",{className:"text-xs text-gray-500 capitalize",children:e.type})]})]},e.id))}):a.jsx("p",{className:"text-gray-500 text-center py-8",children:"No transactions yet"})]}),e&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[a.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Budget Alerts"}),(0,a.jsxs)("div",{className:"space-y-3",children:[m>=90&&(0,a.jsxs)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-red-800",children:["⚠️ Critical: You've used ",m.toFixed(1),"% of your annual budget"]}),(0,a.jsxs)("p",{className:"text-xs text-red-600 mt-1",children:["Only ฿",e.budget_remaining.toLocaleString()," remaining"]})]}),m>=70&&m<90&&(0,a.jsxs)("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-yellow-800",children:["⚠️ Warning: You've used ",m.toFixed(1),"% of your annual budget"]}),(0,a.jsxs)("p",{className:"text-xs text-yellow-600 mt-1",children:["฿",e.budget_remaining.toLocaleString()," remaining"]})]}),30>=g(e.expires_at)&&(0,a.jsxs)("div",{className:"p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-orange-800",children:["\uD83D\uDD50 Budget expires in ",g(e.expires_at)," days"]}),a.jsx("p",{className:"text-xs text-orange-600 mt-1",children:"Contact admin for renewal"})]}),m<70&&g(e.expires_at)>30&&(0,a.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-green-800",children:["✓ Budget is healthy: ",(100-m).toFixed(1),"% remaining"]}),(0,a.jsxs)("p",{className:"text-xs text-green-600 mt-1",children:["฿",e.budget_remaining.toLocaleString()," available for use"]})]})]})]})]})})}},6824:(e,t,s)=>{"use strict";s.d(t,{L2:()=>d,Vj:()=>c,Z1:()=>u,ZP:()=>r,cC:()=>m,h3:()=>n,hO:()=>l,kv:()=>i,nN:()=>x,oZ:()=>o,w2:()=>g,xf:()=>p});let a=s(94464).Z.create({baseURL:"https://loyalty.sarnies.tech/api",headers:{"Content-Type":"application/json"},withCredentials:!0});a.interceptors.request.use(e=>e),a.interceptors.response.use(e=>e,e=>{if(e.response?.status===401){let t=window.location.pathname.includes("/login"),s=e.config?.url?.includes("/auth/"),a=localStorage.getItem("auth-storage");t||s||!a||(localStorage.removeItem("auth-storage"),window.location.href="/login")}return Promise.reject(e)});let r=a,i={staffLogin:(e,t)=>a.post("/auth/login",{email:e,password:t}),sendOTP:e=>a.post("/auth/otp/send",{phone:e}),verifyOTP:(e,t)=>a.post("/auth/otp/verify",{phone:e,otp:t}),sendEmailOTP:e=>a.post("/auth/otp/email/send",{email:e}),verifyEmailOTP:(e,t)=>a.post("/auth/otp/email/verify",{email:e,otp:t}),sendMagicLink:e=>a.post("/auth/magic-link/send",{email:e}),verifyMagicLink:e=>a.get(`/auth/magic-link/verify/${e}`)},n={getAll:e=>a.get("/users",{params:e}),getOne:e=>a.get(`/users/${e}`),update:(e,t)=>a.put(`/users/${e}`,t),adjustPoints:(e,t,s)=>a.post(`/users/${e}/points`,{points:t,reason:s}),getStaticQR:e=>a.get(`/users/${e}/static-qr`),getVoucherInstances:(e,t)=>a.get(`/users/${e}/voucher-instances`,{params:t?{status:t}:void 0})},l={getAll:()=>a.get("/vouchers"),getAllAdmin:()=>a.get("/vouchers/all"),getOne:e=>a.get(`/vouchers/${e}`),create:e=>a.post("/vouchers",e),update:(e,t)=>a.patch(`/vouchers/${e}`,t),delete:e=>a.delete(`/vouchers/${e}`),redeem:(e,t)=>a.post(`/vouchers/${e}/redeem`,{user_id:t}),getInstances:(e,t)=>a.get(`/vouchers/instances/${e}`,{params:{status:t}})},d={earnPoints:(e,t,s)=>a.post("/transactions/earn",{user_id:e,amount:t,outlet:s}),redeemVoucher:(e,t,s)=>a.post("/transactions/redeem",{user_id:e,voucher_id:t,outlet:s}),getAll:e=>a.get("/transactions",{params:e})},o={getAll:e=>a.get("/announcements",{params:{user_type:e}}),getAllAdmin:()=>a.get("/announcements/all"),getById:e=>a.get(`/announcements/${e}`),create:e=>a.post("/announcements",e),update:(e,t)=>a.patch(`/announcements/${e}`,t),delete:e=>a.delete(`/announcements/${e}`)},c={getCredits:()=>a.get("/investors/credits"),getOutletCredits:e=>a.get(`/investors/credits/outlet/${e}`),getTransactions:e=>a.get("/investors/transactions",{params:e}),allocateOutletCredits:(e,t)=>a.post(`/investors/admin/${e}/outlet-credits`,t),allocateGroupCredits:(e,t)=>a.post(`/investors/admin/${e}/group-credits`,t),adjustCredits:(e,t)=>a.patch(`/investors/admin/${e}/credits/adjust`,t),getExpiringCredits:e=>a.get("/investors/admin/credits/expiring",{params:e?{days:e}:void 0})},x={getBudget:()=>a.get("/media/budget"),getTransactions:e=>a.get("/media/transactions",{params:e}),setBudget:(e,t)=>a.post(`/media/admin/${e}/budget`,t),adjustBudget:(e,t)=>a.patch(`/media/admin/${e}/budget/adjust`,t),getExpiringBudgets:e=>a.get("/media/admin/budgets/expiring",{params:e?{days:e}:void 0}),getUsageReport:()=>a.get("/media/admin/usage-report")},g={getAll:()=>a.get("/settings"),getOne:e=>a.get(`/settings/${e}`),update:(e,t)=>a.put(`/settings/${e}`,{value:t}),bulkUpdate:e=>a.put("/settings",{settings:e}),create:e=>a.post("/settings",e)},m={getVapidKey:()=>a.get("/notifications/vapid-public-key"),subscribe:e=>a.post("/notifications/subscribe",{subscription:e.toJSON()}),unsubscribe:e=>a.post("/notifications/unsubscribe",{endpoint:e}),getStatus:()=>a.get("/notifications/status"),getPreferences:()=>a.get("/notifications/preferences"),updatePreferences:e=>a.patch("/notifications/preferences",{preferences:e}),sendTest:()=>a.post("/notifications/test"),getHistory:e=>a.get("/notifications/history",{params:e}),adminSend:e=>a.post("/notifications/admin/send",e),adminBroadcast:e=>a.post("/notifications/admin/broadcast",e),adminStats:()=>a.get("/notifications/admin/stats"),adminProcessQueue:()=>a.post("/notifications/admin/process-queue")},u={getMyCode:()=>a.get("/referrals/my-code"),getMyReferrals:()=>a.get("/referrals/my-referrals"),validateCode:e=>a.get(`/referrals/validate/${e}`),applyCode:e=>a.post("/referrals/apply",e),getAdminStats:()=>a.get("/referrals/admin/stats")},p={getAll:()=>a.get("/pos/keys"),create:e=>a.post("/pos/keys",e),revoke:e=>a.delete(`/pos/keys/${e}`),getLogs:(e,t)=>a.get(`/pos/keys/${e}/logs`,{params:t}),getStats:()=>a.get("/pos/keys/stats")}},66697:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(76557).Z)("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]])},37358:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(76557).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},71821:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(76557).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},15419:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(68570).createProxy)(String.raw`/root/Loyalty/frontend/app/media/dashboard/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[5380,4464,5814],()=>s(16050));module.exports=a})();