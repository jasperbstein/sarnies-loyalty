(()=>{var e={};e.id=1705,e.ids=[1705],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},83904:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.Z,__next_app__:()=>x,originalPathname:()=>c,pages:()=>o,routeModule:()=>m,tree:()=>n}),t(86609),t(95478),t(26083),t(96560);var r=t(23191),a=t(88716),l=t(48001),i=t(95231),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);t.d(s,d);let n=["",{children:["staff",{children:["simulator",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,86609)),"/root/Loyalty/frontend/app/staff/simulator/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,95478)),"/root/Loyalty/frontend/app/layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,26083)),"/root/Loyalty/frontend/app/error.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,96560)),"/root/Loyalty/frontend/app/not-found.tsx"]}],o=["/root/Loyalty/frontend/app/staff/simulator/page.tsx"],c="/staff/simulator/page",x={require:t,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/staff/simulator/page",pathname:"/staff/simulator",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},41946:(e,s,t)=>{Promise.resolve().then(t.bind(t,74654))},74654:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>f});var r=t(10326),a=t(17577),l=t(36143),i=t(6762),d=t(99048),n=t(6824);let o=(0,t(76557).Z)("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);var c=t(71821),x=t(98908),m=t(79635),u=t(94019),p=t(72257),h=t(22915),b=t(54659),g=t(55358),y=t.n(g);function f(){let[e,s]=(0,a.useState)("select"),[t,g]=(0,a.useState)([]),[f,j]=(0,a.useState)([]),[v,N]=(0,a.useState)(null),[w,k]=(0,a.useState)(null),[_,S]=(0,a.useState)(""),[P,Z]=(0,a.useState)("Sukhumvit"),[q,C]=(0,a.useState)(!1),[M,A]=(0,a.useState)("earn"),L=e=>{N(e),"earn"===M&&s("add-points")},$=e=>{if(!v){y().error("Please select a customer first");return}k(e),s("redeem-voucher")},T=async e=>{if(e.preventDefault(),v&&_){C(!0);try{let e=await n.L2.earnPoints(v.id,parseFloat(_),P);y().success(`${e.data.points_earned} points added successfully!`),s("success");let t=await n.ZP.get(`/users/${v.id}`);N(t.data),setTimeout(()=>E(),3e3)}catch(e){y().error(e.response?.data?.error||"Failed to add points")}finally{C(!1)}}},R=async()=>{if(v&&w){C(!0);try{await n.L2.redeemVoucher(v.id,w.id,P),y().success("Voucher redeemed successfully!"),s("success");let e=await n.ZP.get(`/users/${v.id}`);N(e.data),setTimeout(()=>E(),3e3)}catch(e){y().error(e.response?.data?.error||"Failed to redeem voucher")}finally{C(!1)}}},F=()=>_?Math.floor(parseFloat(_)/100):0,E=()=>{s("select"),N(null),k(null),S(""),Z("Sukhumvit")};return r.jsx(l.Z,{children:(0,r.jsxs)("div",{className:"max-w-5xl mx-auto space-y-6",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl shadow-lg p-6 text-white",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx(o,{className:"w-7 h-7"}),r.jsx("h2",{className:"text-2xl font-bold",children:"Simulation Mode"})]}),r.jsx("p",{className:"text-purple-100",children:"Test all app features without needing two devices. Select customers and simulate transactions."})]}),"select"===e&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-6 border border-gray-200",children:[r.jsx("h3",{className:"text-lg font-bold text-black mb-4",children:"Select Simulation Type"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("button",{onClick:()=>A("earn"),className:`p-6 rounded-xl border-2 transition-all ${"earn"===M?"border-green-500 bg-green-50":"border-gray-200 hover:border-green-300"}`,children:[r.jsx(c.Z,{className:`w-8 h-8 mx-auto mb-2 ${"earn"===M?"text-green-600":"text-gray-400"}`}),r.jsx("p",{className:`font-bold ${"earn"===M?"text-green-900":"text-gray-700"}`,children:"Earn Points"}),r.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Simulate customer purchase"})]}),(0,r.jsxs)("button",{onClick:()=>A("redeem"),className:`p-6 rounded-xl border-2 transition-all ${"redeem"===M?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-purple-300"}`,children:[r.jsx(x.Z,{className:`w-8 h-8 mx-auto mb-2 ${"redeem"===M?"text-purple-600":"text-gray-400"}`}),r.jsx("p",{className:`font-bold ${"redeem"===M?"text-purple-900":"text-gray-700"}`,children:"Redeem Voucher"}),r.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Simulate voucher redemption"})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-6 border border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[r.jsx(m.Z,{className:"w-5 h-5 text-gray-700"}),(0,r.jsxs)("h3",{className:"text-lg font-bold text-black",children:["Step 1: Select Customer",v&&r.jsx("span",{className:"ml-2 text-green-600",children:"✓"})]})]}),r.jsx("div",{className:"grid grid-cols-2 gap-3",children:t.map(e=>r.jsx("button",{onClick:()=>L(e),className:`text-left p-4 rounded-xl border-2 transition-all ${v?.id===e.id?"border-black bg-gray-50":"border-gray-200 hover:border-gray-400"}`,children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-black to-gray-700 rounded-full flex items-center justify-center text-white font-bold",children:e.name.charAt(0)}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("p",{className:"font-bold text-black truncate",children:[e.name," ",e.surname||""]}),r.jsx("p",{className:"text-xs text-gray-600 truncate",children:e.phone}),(0,r.jsxs)("p",{className:"text-xs font-medium text-amber-700",children:[e.points_balance," points"]})]})]})},e.id))})]}),"redeem"===M&&(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-6 border border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[r.jsx(x.Z,{className:"w-5 h-5 text-gray-700"}),(0,r.jsxs)("h3",{className:"text-lg font-bold text-black",children:["Step 2: Select Voucher",w&&r.jsx("span",{className:"ml-2 text-green-600",children:"✓"})]})]}),v?r.jsx("div",{className:"grid grid-cols-2 gap-3",children:f.filter(e=>!e.is_staff_voucher&&v.points_balance>=e.points_required).map(e=>(0,r.jsxs)("button",{onClick:()=>$(e),className:"text-left p-4 rounded-xl border-2 border-gray-200 hover:border-purple-400 transition-all",children:[r.jsx("p",{className:"font-bold text-black text-sm mb-1",children:e.title}),r.jsx("p",{className:"text-xs text-gray-600 mb-2 line-clamp-2",children:e.description}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("span",{className:"text-xs font-bold text-green-700",children:["฿",Number(e.cash_value).toFixed(2)]}),(0,r.jsxs)("span",{className:"text-xs font-bold text-amber-700",children:[e.points_required," pts"]})]})]},e.id))}):r.jsx("p",{className:"text-center text-gray-500 py-8",children:"Please select a customer first"})]})]}),"add-points"===e&&v&&(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx(i.Z,{customer:v,qrType:"loyalty_id",showFullDetails:!0}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-6 border border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-xl font-bold text-black",children:"Add Points for Purchase"}),r.jsx("button",{onClick:E,className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:r.jsx(u.Z,{size:24})})]}),(0,r.jsxs)("form",{onSubmit:T,className:"space-y-5",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Purchase Amount (฿) *"}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx("div",{className:"absolute left-4 top-1/2 -translate-y-1/2",children:r.jsx(c.Z,{className:"w-5 h-5 text-gray-400"})}),r.jsx("input",{type:"number",step:"0.01",min:"0",className:"w-full pl-12 pr-4 py-4 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-black focus:border-black text-lg font-semibold",placeholder:"350.00",value:_,onChange:e=>S(e.target.value),required:!0})]}),r.jsx("div",{className:"mt-3 p-4 bg-gradient-to-br from-amber-50 to-amber-100 rounded-xl border border-amber-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(p.Z,{className:"w-5 h-5 text-amber-700"}),r.jsx("span",{className:"font-medium text-amber-900",children:"Points to Award"})]}),(0,r.jsxs)("span",{className:"text-2xl font-bold text-amber-800",children:["+",F()]})]})})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Outlet Location *"}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx("div",{className:"absolute left-4 top-1/2 -translate-y-1/2",children:r.jsx(h.Z,{className:"w-5 h-5 text-gray-400"})}),(0,r.jsxs)("select",{className:"w-full pl-12 pr-4 py-4 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-black focus:border-black text-base font-medium appearance-none bg-white",value:P,onChange:e=>Z(e.target.value),required:!0,children:[r.jsx("option",{value:"Sukhumvit",children:"Sarnies Sukhumvit"}),r.jsx("option",{value:"Old Town",children:"Sarnies Old Town"}),r.jsx("option",{value:"Roastery",children:"Sarnies Roastery"})]})]})]}),(0,r.jsxs)("div",{className:"flex gap-3 pt-4",children:[r.jsx("button",{type:"submit",className:"flex-1 bg-black text-white py-4 rounded-xl font-bold hover:bg-gray-800 transition-all shadow-sm hover:shadow-md disabled:opacity-50",disabled:q||!_,children:q?"Processing...":`Confirm & Add ${F()} Points`}),r.jsx("button",{type:"button",onClick:E,className:"px-6 py-4 border-2 border-gray-300 text-gray-700 rounded-xl font-bold hover:bg-gray-50 transition-colors",disabled:q,children:"Cancel"})]})]})]})]}),"redeem-voucher"===e&&v&&w&&(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx(i.Z,{customer:v,qrType:"voucher_redemption",showFullDetails:!1}),r.jsx(d.Z,{voucher:w,customerPointsAfterRedemption:v.points_balance-w.points_required,showFullDetails:!0}),r.jsx("div",{className:"bg-white rounded-2xl shadow-sm p-6 border border-gray-200",children:(0,r.jsxs)("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:R,className:"flex-1 bg-green-600 text-white py-5 rounded-xl font-bold hover:bg-green-700 transition-all shadow-sm hover:shadow-md text-lg disabled:opacity-50",disabled:q,children:q?"Processing...":"Redeem Voucher Now"}),r.jsx("button",{onClick:E,className:"px-6 py-5 border-2 border-gray-300 text-gray-700 rounded-xl font-bold hover:bg-gray-50 transition-colors",disabled:q,children:"Cancel"})]})})]}),"success"===e&&(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-12 text-center border-2 border-green-200",children:[r.jsx("div",{className:"w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:r.jsx(b.Z,{size:60,className:"text-green-600"})}),r.jsx("h3",{className:"text-3xl font-bold text-black mb-3",children:"Success!"}),r.jsx("p",{className:"text-gray-600 text-lg mb-8",children:"Simulation completed successfully"}),r.jsx("button",{onClick:E,className:"bg-black text-white px-8 py-4 rounded-xl font-bold hover:bg-gray-800 transition-all shadow-sm hover:shadow-md",children:"Run Another Simulation"})]})]})})}},99048:(e,s,t)=>{"use strict";t.d(s,{Z:()=>m});var r=t(10326),a=t(17577),l=t(46226),i=t(48998),d=t(71821),n=t(997),o=t(77636),c=t(87888),x=t(54659);function m({voucher:e,qrExpiry:s,customerPointsAfterRedemption:t,showFullDetails:m=!0}){let[u,p]=(0,a.useState)(null),[h,b]=(0,a.useState)(!1);return(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border-2 border-gray-200 overflow-hidden",children:[s&&r.jsx("div",{className:`${h?"bg-red-600":u&&u<120?"bg-orange-600":"bg-green-600"} text-white px-5 py-2.5`,children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(i.Z,{className:"w-4 h-4"}),r.jsx("span",{className:"font-semibold text-sm",children:h?"QR CODE EXPIRED":"QR Code Expires In"})]}),!h&&null!==u&&r.jsx("span",{className:"text-xl font-bold font-mono",children:`${Math.floor(u/60)}:${(u%60).toString().padStart(2,"0")}`})]})}),e.image_url&&r.jsx("div",{className:"relative aspect-[16/9] bg-gray-100",children:r.jsx(l.default,{src:e.image_url,alt:e.title,fill:!0,className:"object-cover",sizes:"(max-width: 768px) 100vw, 600px"})}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between gap-4 mb-4",children:[(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("h3",{className:"text-2xl font-bold text-black mb-2",children:e.title}),r.jsx("p",{className:"text-gray-600 leading-relaxed",children:e.description})]}),r.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-700 text-xs font-bold rounded-full whitespace-nowrap",children:(()=>{switch(e.voucher_type){case"free_item":return"Free Item";case"discount_amount":return"Discount";case"percentage_discount":return"Percentage Off";case"merch":return"Merchandise";default:return"Reward"}})()})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-4 border border-green-200",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx(d.Z,{className:"w-4 h-4 text-green-700"}),r.jsx("p",{className:"text-xs font-medium text-green-700",children:"Cash Value"})]}),(0,r.jsxs)("p",{className:"text-3xl font-bold text-green-800",children:["฿",Number(e.cash_value).toFixed(2)]})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-br from-amber-50 to-amber-100 rounded-xl p-4 border border-amber-200",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx(n.Z,{className:"w-4 h-4 text-amber-700"}),r.jsx("p",{className:"text-xs font-medium text-amber-700",children:"Points Cost"})]}),r.jsx("p",{className:"text-3xl font-bold text-amber-800",children:e.points_required})]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(o.Z,{className:"w-4 h-4 text-gray-600"}),r.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Valid Locations"})]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:(e.locations?e.locations.split(",").map(e=>e.trim().toUpperCase()):["ALL LOCATIONS"]).map((e,s)=>r.jsx("span",{className:"px-3 py-1.5 bg-blue-100 text-blue-800 text-xs font-bold rounded-full border border-blue-200",children:e},s))})]}),m&&(0,r.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,r.jsxs)("div",{className:"flex items-start gap-2 p-3 bg-gray-50 rounded-lg",children:[r.jsx(c.Z,{className:"w-4 h-4 text-gray-600 mt-0.5 flex-shrink-0"}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Expiry Policy"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["no_expiry"===e.expiry_type&&"This voucher has no expiry date","days_after_redeem"===e.expiry_type&&e.expiry_days&&`Valid for ${e.expiry_days} days after redemption`,"fixed_date"===e.expiry_type&&"Limited time offer - check specific date"]})]})]}),(0,r.jsxs)("div",{className:"flex items-start gap-2 p-3 bg-amber-50 rounded-lg border border-amber-200",children:[r.jsx(x.Z,{className:"w-4 h-4 text-amber-700 mt-0.5 flex-shrink-0"}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-bold text-amber-900",children:"One-Time Use Only"}),r.jsx("p",{className:"text-sm text-amber-800",children:"This voucher can only be redeemed once"})]})]}),void 0!==t&&(0,r.jsxs)("div",{className:"flex items-start gap-2 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[r.jsx(n.Z,{className:"w-4 h-4 text-blue-700 mt-0.5 flex-shrink-0"}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Customer Remaining Points"}),(0,r.jsxs)("p",{className:"text-lg font-bold text-blue-700",children:[t," points"]})]})]})]})]})]})}},72257:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(76557).Z)("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]])},48998:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(76557).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},71821:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(76557).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},22915:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(76557).Z)("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]])},86609:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(68570).createProxy)(String.raw`/root/Loyalty/frontend/app/staff/simulator/page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[5380,2696,4464,6226,5814,4810],()=>t(83904));module.exports=r})();