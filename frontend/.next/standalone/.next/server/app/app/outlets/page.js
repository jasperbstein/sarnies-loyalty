(()=>{var e={};e.id=4302,e.ids=[4302],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},23927:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.Z,__next_app__:()=>u,originalPathname:()=>d,pages:()=>c,routeModule:()=>p,tree:()=>n}),s(73202),s(95478),s(26083),s(96560);var a=s(23191),r=s(88716),i=s(48001),l=s(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let n=["",{children:["app",{children:["outlets",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,73202)),"/root/Loyalty/frontend/app/app/outlets/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,95478)),"/root/Loyalty/frontend/app/layout.tsx"],error:[()=>Promise.resolve().then(s.bind(s,26083)),"/root/Loyalty/frontend/app/error.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,96560)),"/root/Loyalty/frontend/app/not-found.tsx"]}],c=["/root/Loyalty/frontend/app/app/outlets/page.tsx"],d="/app/outlets/page",u={require:s,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/app/outlets/page",pathname:"/app/outlets",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},87187:(e,t,s)=>{Promise.resolve().then(s.bind(s,33184))},33184:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var a=s(10326),r=s(17577),i=s(93251),l=s(16205),o=s(77636);let n=(0,s(76557).Z)("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);var c=s(94464),d=s(36607),u=s(55358),p=s.n(u);function x(){let{user:e,token:t}=(0,l.t)(),[s,u]=(0,r.useState)([]),[x,h]=(0,r.useState)(!0),[m,y]=(0,r.useState)(!1),[b,g]=(0,r.useState)(null),[f,v]=(0,r.useState)(!1),j=e=>{let t=`https://www.google.com/maps/dir/?api=1&destination=${e.latitude},${e.longitude}`;window.open(t,"_blank")},N=e=>e?e<1e3?`${Math.round(e)}m`:`${(e/1e3).toFixed(1)}km`:null;return a.jsx(i.Z,{children:(0,a.jsxs)("div",{className:"flex flex-col gap-6 pb-20",children:[(0,a.jsxs)("header",{children:[a.jsx("h1",{className:"text-[28px] font-bold text-gray-900",children:"Sarnies Outlets"}),a.jsx("p",{className:"text-gray-600 mt-2",children:"Find a location near you"})]}),!f&&a.jsx("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 rounded-2xl p-6 border border-amber-200",children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(o.Z,{className:"w-6 h-6 text-amber-600"})}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Find nearest outlets"}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Enable location to see outlets sorted by distance and get directions"}),a.jsx("button",{onClick:()=>{if(y(!0),!navigator.geolocation){p().error("Geolocation is not supported by your browser"),y(!1);return}navigator.geolocation.getCurrentPosition(async s=>{let{latitude:a,longitude:r}=s.coords;if(g({lat:a,lon:r}),v(!0),e&&t)try{await c.Z.put(`${(0,d.SV)()}/api/outlets/${e.id}/location`,{latitude:a,longitude:r,location_enabled:!0},{headers:{Authorization:`Bearer ${t}`}})}catch(e){}try{let e=await c.Z.get(`${(0,d.SV)()}/api/outlets/nearby?latitude=${a}&longitude=${r}&radius=50000`);u(e.data),p().success("Location updated!")}catch(e){}y(!1)},e=>{p().error("Unable to get your location"),y(!1)})},disabled:m,className:"bg-amber-600 hover:bg-amber-700 text-white px-6 py-2.5 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:m?(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Getting location..."]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(n,{className:"w-4 h-4"}),"Enable Location"]})})]})]})}),x&&a.jsx("div",{className:"space-y-4",children:[1,2,3].map(e=>a.jsx("div",{className:"bg-gray-200 rounded-2xl h-32 animate-pulse"},e))}),!x&&a.jsx("div",{className:"space-y-4",children:s.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 border border-gray-200 shadow-sm hover:shadow-md transition-shadow",children:[a.jsx("div",{className:"flex justify-between items-start mb-4",children:(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-bold text-gray-900",children:e.name}),e.distance&&(0,a.jsxs)("div",{className:"flex items-center gap-1 text-amber-600 font-semibold mt-1",children:[a.jsx(n,{className:"w-4 h-4"}),N(e.distance)," away"]})]})}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3 text-sm text-gray-600",children:[a.jsx(o.Z,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),a.jsx("p",{children:e.address})]}),(0,a.jsxs)("button",{onClick:()=>j(e),className:"w-full bg-gray-900 hover:bg-gray-800 text-white py-3 rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[a.jsx(n,{className:"w-4 h-4"}),"Get Directions"]})]})]},e.id))}),!x&&0===s.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[a.jsx(o.Z,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"No outlets found"})]})]})})}},93251:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var a=s(10326),r=s(35047),i=s(16205),l=s(95920),o=s(21985),n=s(70717),c=s(79635),d=s(71810),u=s(17577);function p({children:e,hideLogout:t=!1}){let s=(0,r.useRouter)(),p=(0,r.usePathname)(),{user:x,logout:h}=(0,i.t)(),[m,y]=(0,u.useState)(!1);if(!m)return a.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:a.jsx("div",{className:"w-6 h-6 border-2 border-black border-t-transparent rounded-full animate-spin"})});if(!(x&&("customer"===x.type||"staff"===x.type||"customer"===x.user_type||"employee"===x.user_type||"staff"===x.user_type)))return null;let b=[{icon:l.Z,label:"HOME",path:"/app/home"},{icon:o.Z,label:"VOUCHERS",path:"/app/vouchers"},{icon:n.Z,label:"HISTORY",path:"/app/activity"},{icon:c.Z,label:"PROFILE",path:"/app/profile"}];return(0,a.jsxs)("div",{className:"min-h-screen bg-white",children:[a.jsx("header",{className:"fixed top-0 left-0 right-0 h-header bg-black z-fixed",children:(0,a.jsxs)("div",{className:"h-full max-w-container mx-auto px-6 flex items-center justify-between",children:[a.jsx("span",{className:"text-label text-white",children:"SARNIES"}),!t&&a.jsx("button",{onClick:()=>{confirm("Are you sure you want to log out?")&&(h(),s.push("/login"))},className:"p-2.5 -mr-2.5 text-white/60 hover:text-white transition-opacity","aria-label":"Log out",type:"button",children:a.jsx(d.Z,{className:"w-[18px] h-[18px]",strokeWidth:1.5})})]})}),a.jsx("main",{className:"pt-header pb-[calc(var(--nav-height)+env(safe-area-inset-bottom,0px)+16px)] min-h-screen",children:a.jsx("div",{className:"max-w-container mx-auto px-5 py-6",children:e})}),a.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-fixed pb-safe",children:a.jsx("div",{className:"max-w-container mx-auto px-4",children:a.jsx("div",{className:"flex justify-around items-start h-[60px] pt-2.5",children:b.map(e=>{let t=e.icon,r=p===e.path||p.startsWith(e.path);return(0,a.jsxs)("button",{onClick:()=>s.push(e.path),className:"flex flex-col items-center justify-start min-w-[64px] py-1 transition-all active:scale-95",children:[(0,a.jsxs)("div",{className:"relative mb-1",children:[a.jsx(t,{className:`w-[22px] h-[22px] transition-colors ${r?"text-black stroke-[2]":"text-gray-400 stroke-[1.5]"}`}),r&&a.jsx("div",{className:`absolute -bottom-1 left-1/2 -translate-x-1/2 w-1 h-1 rounded-full ${x?.user_type==="employee"?"bg-mustard":"bg-accent"}`})]}),a.jsx("span",{className:`text-nav ${r?"text-black":"text-gray-400"}`,children:e.label})]},e.path)})})})})]})}},36607:(e,t,s)=>{"use strict";function a(){let e="https://loyalty.sarnies.tech/api";return e?e.startsWith("/")?"":e.replace(/\/api\/?$/,""):"http://localhost:3000"}function r(){return"https://loyalty.sarnies.tech/api"}s.d(t,{SV:()=>a,kG:()=>r})},16205:(e,t,s)=>{"use strict";s.d(t,{t:()=>i});var a=s(60114),r=s(85251);let i=(0,a.Ue)()((0,r.tJ)(e=>({user:null,token:null,hasHydrated:!1,setAuth:(t,s)=>{e({user:t,token:s})},logout:()=>{e({user:null,token:null})},updateUser:t=>{e(e=>e.user?{user:{...e.user,...t}}:e)},setHasHydrated:t=>{e({hasHydrated:t})}}),{name:"auth-storage",storage:(0,r.FL)(()=>localStorage),onRehydrateStorage:()=>e=>{e?.setHasHydrated(!0)}}))},70717:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(76557).Z)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]])},71810:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(76557).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},77636:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(76557).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},21985:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(76557).Z)("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]])},79635:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(76557).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},73202:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(68570).createProxy)(String.raw`/root/Loyalty/frontend/app/app/outlets/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[5380,2696,4464,5814],()=>s(23927));module.exports=a})();