(()=>{var e={};e.id=4152,e.ids=[4152],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},58359:()=>{},93739:()=>{},23766:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.Z,__next_app__:()=>x,originalPathname:()=>o,pages:()=>d,routeModule:()=>m,tree:()=>n}),s(17025),s(95478),s(26083),s(96560);var a=s(23191),r=s(88716),l=s(48001),i=s(95231),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);s.d(t,c);let n=["",{children:["app",{children:["home",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,17025)),"/root/Loyalty/frontend/app/app/home/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,95478)),"/root/Loyalty/frontend/app/layout.tsx"],error:[()=>Promise.resolve().then(s.bind(s,26083)),"/root/Loyalty/frontend/app/error.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,96560)),"/root/Loyalty/frontend/app/not-found.tsx"]}],d=["/root/Loyalty/frontend/app/app/home/page.tsx"],o="/app/home/page",x={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/app/home/page",pathname:"/app/home",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},72277:(e,t,s)=>{Promise.resolve().then(s.bind(s,52471))},52471:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var a=s(10326),r=s(17577),l=s(92447);let i=({name:e,memberId:t,qrCodeUrl:s,qrLoading:r,userType:i})=>"employee"===i?(0,a.jsxs)("section",{className:"w-full relative rounded-xl overflow-hidden min-h-[160px]",children:[a.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url(/pattern-bg.jpg)"}}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black/30 to-black/50"}),a.jsx("div",{className:"relative z-10 p-6",children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-[10px] font-medium uppercase tracking-[0.15em] mb-1.5",style:{color:"rgba(255,255,255,0.7)",textShadow:"0 2px 12px rgba(0,0,0,0.8), 0 0 20px rgba(0,0,0,0.6)"},children:"Welcome back"}),a.jsx("h1",{className:"text-[22px] font-bold uppercase tracking-[0.2em] text-white mb-2",style:{textShadow:"0 2px 12px rgba(0,0,0,0.8), 0 0 20px rgba(0,0,0,0.6)"},children:e.toUpperCase()}),(0,a.jsxs)("p",{className:"text-xs",style:{color:"rgba(255,255,255,0.7)",textShadow:"0 2px 8px rgba(0,0,0,0.6)"},children:["Employee ID: #",t]})]}),a.jsx("div",{className:"flex-shrink-0 bg-white rounded-xl w-[100px] h-[100px] flex items-center justify-center",children:r?a.jsx("div",{className:"w-5 h-5 border-2 border-black border-t-transparent rounded-full animate-spin"}):s?a.jsx("img",{src:s,alt:"QR Code",className:"w-[80px] h-[80px]"}):a.jsx(l.Z,{className:"w-14 h-14 text-black"})})]})})]}):(0,a.jsxs)("section",{className:"w-full card-dark",children:[(0,a.jsxs)("div",{className:"mb-4",children:[a.jsx("p",{className:"text-caption text-white/40 mb-1",children:"Welcome back"}),a.jsx("h1",{className:"text-heading text-white",children:e.toUpperCase()}),(0,a.jsxs)("p",{className:"text-caption text-white/30 mt-1",children:["Member #",t]})]}),a.jsx("div",{className:"h-px bg-white/10 mb-4"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"flex-shrink-0 bg-white rounded-lg p-3",children:r?a.jsx("div",{className:"w-[100px] h-[100px] flex items-center justify-center",children:a.jsx("div",{className:"w-5 h-5 border-2 border-black border-t-transparent rounded-full animate-spin"})}):s?a.jsx("img",{src:s,alt:"QR Code",className:"w-[100px] h-[100px]"}):a.jsx("div",{className:"w-[100px] h-[100px] flex items-center justify-center bg-gray-100 rounded",children:a.jsx(l.Z,{className:"w-10 h-10 text-gray-300"})})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("div",{className:"w-5 h-5 rounded-full bg-accent/20 flex items-center justify-center",children:a.jsx(l.Z,{className:"w-3 h-3 text-accent"})}),a.jsx("span",{className:"text-nav text-accent",children:"SCAN TO REDEEM"})]}),a.jsx("p",{className:"text-caption text-white/50",children:"Earn & redeem points"})]})]})]});var c=s(33734);let n=({points:e,nextRewardAt:t})=>{let s=Math.min(e/t,1),r=t-e;return a.jsx("div",{className:"card",children:(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[a.jsx("p",{className:"text-nav text-gray-400 mb-1",children:"YOUR POINTS"}),a.jsx("p",{className:"text-3xl font-medium text-accent",children:e})]}),a.jsx("div",{className:"flex justify-center",children:(0,a.jsxs)("div",{className:"badge-accent",children:[a.jsx(c.Z,{className:"w-3 h-3 fill-accent text-accent mr-1"}),a.jsx("span",{className:"text-body",children:e>=t?"Reward unlocked!":`${r} points to reward`})]})}),(0,a.jsxs)("div",{className:"mt-1",children:[(0,a.jsxs)("div",{className:"flex justify-between text-caption text-gray-400 mb-1.5",children:[a.jsx("span",{children:"0"}),a.jsx("span",{children:t})]}),a.jsx("div",{className:"h-1 rounded-full bg-gray-100 overflow-hidden",children:a.jsx("div",{className:"h-full bg-accent rounded-full transition-all duration-slow",style:{width:`${100*s}%`}})})]})]})})};var d=s(39183),o=s(98908),x=s(70717);let m=({onRewards:e,onActivity:t})=>{let s=({icon:e,title:t,subtitle:s,onClick:r})=>(0,a.jsxs)("button",{type:"button",onClick:r,className:"w-full card flex items-center gap-3 p-4 hover:border-gray-300 transition-colors active:scale-[0.98] group",children:[a.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-100 flex items-center justify-center group-hover:bg-gray-200 transition-colors",children:e}),(0,a.jsxs)("div",{className:"flex-1 text-left",children:[a.jsx("p",{className:"text-base font-medium text-black tracking-tight",children:t}),a.jsx("p",{className:"text-caption text-gray-500",children:s})]}),a.jsx(d.Z,{className:"w-4 h-4 text-gray-300 group-hover:translate-x-0.5 transition-transform"})]});return(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[a.jsx("h2",{className:"text-label text-black",children:"QUICK ACTIONS"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsx(s,{icon:a.jsx(o.Z,{className:"w-5 h-5 text-black"}),title:"Rewards",subtitle:"Browse & redeem",onClick:e}),a.jsx(s,{icon:a.jsx(x.Z,{className:"w-5 h-5 text-black"}),title:"History",subtitle:"View activity",onClick:t})]})]})};var p=s(71664);let h=({tag:e,title:t,description:s,imageUrl:r,ctaLabel:l="Read more",onClick:i})=>(0,a.jsxs)("article",{onClick:i,className:"card overflow-hidden flex flex-col cursor-pointer hover:border-gray-300 transition-colors active:scale-[0.98] p-0",children:[(0,a.jsxs)("div",{className:"relative w-full h-[140px] bg-gray-100",children:[r?(0,a.jsxs)(a.Fragment,{children:[a.jsx("img",{src:r,alt:t,className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"})]}):a.jsx("div",{className:"w-full h-full flex items-center justify-center",children:a.jsx(p.Z,{className:"w-10 h-10 text-gray-300"})}),e&&a.jsx("span",{className:"badge-default absolute top-2.5 left-2.5",children:e})]}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col p-4",children:[a.jsx("h3",{className:"text-base font-medium text-black tracking-tight leading-snug line-clamp-2 mb-1.5",children:t}),a.jsx("p",{className:"text-caption text-gray-500 line-clamp-1 flex-1",children:s}),(0,a.jsxs)("div",{className:"flex items-center gap-0.5 mt-3 text-accent",children:[a.jsx("span",{className:"text-caption font-medium",children:l}),a.jsx(d.Z,{className:"w-3.5 h-3.5"})]})]})]});var u=s(35047),b=s(93251),j=s(6824),f=s(16205),g=s(58502),v=s(28632),N=s(94464);s(55358);var y=s(36607),w=s(85567),k=s(54659);function _(){let e=(0,u.useRouter)(),{user:t,token:s,hasHydrated:l}=(0,f.t)(),[c,x]=(0,r.useState)([]),[p,_]=(0,r.useState)(!0),[q,C]=(0,r.useState)(null),[Z,S]=(0,r.useState)(!1),[P,E]=(0,r.useState)(!1),[R,A]=(0,r.useState)(null),[M,O]=(0,r.useState)(null);(0,r.useRef)(null),(0,v.h)();let U=async()=>{try{let e=t?.user_type||"customer",s=await j.oZ.getAll(e);x(s.data.announcements||[])}catch(e){}finally{_(!1)}},I=async()=>{if(t&&s){S(!0);try{let e=await N.Z.get(`${(0,y.SV)()}/api/users/${t.id}/static-qr`,{headers:{Authorization:`Bearer ${s}`,"Cache-Control":"no-cache",Pragma:"no-cache"}});C(e.data.qr_code)}catch(e){}finally{S(!1)}}},V=async()=>{try{let e=(await j.hO.getAll()).data.vouchers||[];if(e.length>0){let t=[...e].sort((e,t)=>(t.total_redemptions||0)-(e.total_redemptions||0));A(t[0])}}catch(e){}},$=async()=>{await U(),await I(),await V()};if(!P||!l)return a.jsx(b.Z,{children:a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsx("div",{className:"w-8 h-8 border-2 border-black border-t-transparent rounded-full animate-spin"})})});let D=t?.user_type==="employee";return(0,a.jsxs)(b.Z,{children:[a.jsx(g.t,{onRefresh:$,children:(0,a.jsxs)("div",{className:"flex flex-col gap-8",children:[a.jsx(i,{name:t?.name||"John",memberId:t?.id?.toString().padStart(6,"0")||"000001",qrCodeUrl:q||void 0,qrLoading:Z,userType:t?.user_type}),!D&&a.jsx(n,{points:t?.points_balance||0,nextRewardAt:25}),D&&(0,a.jsxs)("div",{className:"space-y-3",children:[R&&a.jsx("button",{onClick:()=>e.push(`/app/vouchers/${R.id}`),className:"w-full rounded-xl p-4 text-left transition-all group bg-white border border-black/10 border-l-4 border-l-mustard hover:bg-gray-50 active:scale-[0.98]",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3.5",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center bg-mustard",children:a.jsx(w.Z,{className:"w-6 h-6 text-black"})}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-nav text-gray-500 mb-0.5",children:"QUICK REDEEM"}),a.jsx("h3",{className:"text-body font-medium text-black",children:R.title}),R.max_redemptions_per_user_per_day&&(0,a.jsxs)("p",{className:"text-caption text-gray-400 mt-0.5",children:[Math.max(0,R.max_redemptions_per_user_per_day-(R.redeemed_today||0))," left today"]})]})]}),a.jsx(d.Z,{className:"w-5 h-5 text-gray-400 group-hover:translate-x-0.5 transition-transform"})]})}),a.jsx("button",{onClick:()=>e.push("/app/vouchers"),className:"w-full bg-white rounded-xl p-4 border border-black/10 hover:border-black/20 transition-all text-left group active:scale-[0.98]",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3.5",children:[a.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center bg-gray-100 group-hover:bg-gray-200 transition-colors",children:a.jsx(o.Z,{className:"w-5 h-5 text-black"})}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"text-body font-medium text-black",children:"Browse All Benefits"}),a.jsx("p",{className:"text-caption text-gray-500",children:"View all your employee vouchers"})]})]}),a.jsx(d.Z,{className:"w-4 h-4 text-gray-400 group-hover:translate-x-0.5 transition-transform"})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-black/10",children:[a.jsx("h3",{className:"text-nav text-black mb-3",children:"HOW IT WORKS"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-center",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-xs font-semibold mx-auto mb-1.5 bg-mustard text-black",children:"1"}),a.jsx("p",{className:"text-caption text-gray-500",children:"Choose"})]}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-xs font-semibold mx-auto mb-1.5 bg-mustard text-black",children:"2"}),a.jsx("p",{className:"text-caption text-gray-500",children:"Redeem"})]}),(0,a.jsxs)("div",{children:[a.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-xs font-semibold mx-auto mb-1.5 bg-mustard text-black",children:"3"}),a.jsx("p",{className:"text-caption text-gray-500",children:"Show QR"})]})]})]})]}),!D&&a.jsx(m,{onRewards:()=>e.push("/app/rewards"),onActivity:()=>e.push("/app/activity")}),(0,a.jsxs)("div",{children:[a.jsx("h2",{className:"text-nav text-black mb-3",children:"NEWS & UPDATES"}),p?a.jsx("div",{className:"flex justify-center items-center h-32",children:a.jsx("div",{className:"w-5 h-5 border-2 border-black border-t-transparent rounded-full animate-spin"})}):0===c.length?a.jsx("div",{className:"bg-white rounded-xl p-6 text-center border border-black/10",children:a.jsx("p",{className:"text-body text-black/40",children:"No announcements at this time"})}):a.jsx("div",{className:"overflow-x-auto -mx-5 px-5 scrollbar-hide",children:a.jsx("div",{className:"flex gap-3 pb-2",children:c.map(t=>a.jsx("div",{className:"flex-shrink-0 w-[240px]",children:a.jsx(h,{tag:t.announcement_type,title:t.title,description:t.message,imageUrl:t.image_url,onClick:()=>e.push(`/app/announcements/${t.id}`)})},t.id))})})]})]})}),M&&a.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-5",onClick:()=>O(null),children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl p-6 max-w-[320px] w-full text-center animate-in zoom-in-95 duration-200",onClick:e=>e.stopPropagation(),children:[a.jsx("div",{className:"w-16 h-16 rounded-full bg-accent-muted flex items-center justify-center mx-auto mb-5",children:a.jsx(k.Z,{className:"w-9 h-9 text-accent"})}),a.jsx("h2",{className:"text-label text-black mb-3",children:"VOUCHER REDEEMED"}),a.jsx("p",{className:"text-body font-semibold text-black mb-1",children:M.voucher_title}),(0,a.jsxs)("p",{className:"text-body text-black/50 mb-4",children:["at ",M.outlet]}),M.cash_value>0&&a.jsx("div",{className:"badge-accent mb-5",children:(0,a.jsxs)("span",{children:["à¸¿",M.cash_value," Value"]})}),a.jsx("button",{onClick:()=>O(null),className:"btn-primary w-full",children:"Done"})]})})]})}s(80057)},36607:(e,t,s)=>{"use strict";function a(){let e="https://loyalty.sarnies.tech/api";return e?e.startsWith("/")?"":e.replace(/\/api\/?$/,""):"http://localhost:3000"}function r(){return"https://loyalty.sarnies.tech/api"}s.d(t,{SV:()=>a,kG:()=>r})},71664:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(76557).Z)("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]])},17025:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(68570).createProxy)(String.raw`/root/Loyalty/frontend/app/app/home/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[5380,2696,4464,65,5814,916],()=>s(23766));module.exports=a})();