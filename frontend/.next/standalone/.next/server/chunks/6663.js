"use strict";exports.id=6663,exports.ids=[6663],exports.modules={93251:(e,t,s)=>{s.d(t,{Z:()=>p});var a=s(10326),r=s(35047),n=s(16205),i=s(95920),o=s(21985),l=s(70717),c=s(79635),d=s(71810),u=s(17577);function p({children:e,hideLogout:t=!1}){let s=(0,r.useRouter)(),p=(0,r.usePathname)(),{user:m,logout:g}=(0,n.t)(),[h,x]=(0,u.useState)(!1);if(!h)return a.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:a.jsx("div",{className:"w-6 h-6 border-2 border-black border-t-transparent rounded-full animate-spin"})});if(!(m&&("customer"===m.type||"staff"===m.type||"customer"===m.user_type||"employee"===m.user_type||"staff"===m.user_type)))return null;let f=[{icon:i.Z,label:"HOME",path:"/app/home"},{icon:o.Z,label:"VOUCHERS",path:"/app/vouchers"},{icon:l.Z,label:"HISTORY",path:"/app/activity"},{icon:c.Z,label:"PROFILE",path:"/app/profile"}];return(0,a.jsxs)("div",{className:"min-h-screen bg-white",children:[a.jsx("header",{className:"fixed top-0 left-0 right-0 h-header bg-black z-fixed",children:(0,a.jsxs)("div",{className:"h-full max-w-container mx-auto px-6 flex items-center justify-between",children:[a.jsx("span",{className:"text-label text-white",children:"SARNIES"}),!t&&a.jsx("button",{onClick:()=>{confirm("Are you sure you want to log out?")&&(g(),s.push("/login"))},className:"p-2.5 -mr-2.5 text-white/60 hover:text-white transition-opacity","aria-label":"Log out",type:"button",children:a.jsx(d.Z,{className:"w-[18px] h-[18px]",strokeWidth:1.5})})]})}),a.jsx("main",{className:"pt-header pb-[calc(var(--nav-height)+env(safe-area-inset-bottom,0px)+16px)] min-h-screen",children:a.jsx("div",{className:"max-w-container mx-auto px-5 py-6",children:e})}),a.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-fixed pb-safe",children:a.jsx("div",{className:"max-w-container mx-auto px-4",children:a.jsx("div",{className:"flex justify-around items-start h-[60px] pt-2.5",children:f.map(e=>{let t=e.icon,r=p===e.path||p.startsWith(e.path);return(0,a.jsxs)("button",{onClick:()=>s.push(e.path),className:"flex flex-col items-center justify-start min-w-[64px] py-1 transition-all active:scale-95",children:[(0,a.jsxs)("div",{className:"relative mb-1",children:[a.jsx(t,{className:`w-[22px] h-[22px] transition-colors ${r?"text-black stroke-[2]":"text-gray-400 stroke-[1.5]"}`}),r&&a.jsx("div",{className:`absolute -bottom-1 left-1/2 -translate-x-1/2 w-1 h-1 rounded-full ${m?.user_type==="employee"?"bg-mustard":"bg-accent"}`})]}),a.jsx("span",{className:`text-nav ${r?"text-black":"text-gray-400"}`,children:e.label})]},e.path)})})})})]})}},98455:(e,t,s)=>{s.d(t,{Z:()=>i});var a=s(10326),r=s(17577),n=s(94019);function i({isOpen:e,onClose:t,title:s,qrDataUrl:i,expiresAt:o,description:l,loading:c=!1}){let[d,u]=(0,r.useState)(null);return e?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl max-w-md w-full p-6 relative",children:[a.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:a.jsx(n.Z,{className:"w-6 h-6"})}),a.jsx("h2",{className:"text-2xl font-bold text-black mb-2 pr-8",children:s}),l&&a.jsx("p",{className:"text-sm text-gray-600 mb-6",children:l}),a.jsx("div",{className:"flex justify-center mb-6 bg-white p-4 rounded-lg",children:c?a.jsx("div",{className:"w-[320px] h-[320px] flex items-center justify-center",children:a.jsx("div",{className:"w-12 h-12 border-4 border-black border-t-transparent rounded-full animate-spin"})}):i?a.jsx("img",{src:i,alt:"QR Code",className:"w-[320px] h-[320px]",style:{imageRendering:"crisp-edges"}}):a.jsx("div",{className:"w-[320px] h-[320px] flex items-center justify-center bg-gray-100 rounded-lg",children:(0,a.jsxs)("div",{className:"text-center px-6",children:[a.jsx("p",{className:"text-gray-600 font-medium mb-2",children:"QR Code Unavailable"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Please try closing and reopening, or contact support"})]})})}),null!==d&&a.jsx("div",{className:"text-center mb-4",children:d>0?(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Expires in"}),a.jsx("p",{className:"text-3xl font-bold text-black",children:`${Math.floor(d/60)}:${(d%60).toString().padStart(2,"0")}`})]}):a.jsx("p",{className:"text-lg font-semibold text-red-600",children:"QR Code Expired"})}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[a.jsx("p",{className:"text-center text-sm font-semibold text-blue-900 mb-2",children:"Show this QR code to staff at checkout"}),(0,a.jsxs)("div",{className:"text-xs text-blue-800 space-y-1",children:[a.jsx("p",{children:"\uD83D\uDCA1 Turn screen brightness to 100%"}),a.jsx("p",{children:"\uD83D\uDCCF Hold device 15-20cm from scanner camera"}),a.jsx("p",{children:"\uD83D\uDCF1 Keep screen flat and steady"}),a.jsx("p",{children:"\uD83D\uDDA5ï¸ Scanning from computer screen? Tilt screen to avoid glare"})]})]}),a.jsx("button",{onClick:t,className:"w-full bg-black text-white py-3 rounded-md font-medium hover:bg-gray-800 transition-colors",children:"Done"})]})}):null}},6824:(e,t,s)=>{s.d(t,{L2:()=>l,Vj:()=>d,Z1:()=>g,ZP:()=>r,cC:()=>m,h3:()=>i,hO:()=>o,kv:()=>n,nN:()=>u,oZ:()=>c,w2:()=>p,xf:()=>h});let a=s(94464).Z.create({baseURL:"https://loyalty.sarnies.tech/api",headers:{"Content-Type":"application/json"},withCredentials:!0});a.interceptors.request.use(e=>e),a.interceptors.response.use(e=>e,e=>{if(e.response?.status===401){let t=window.location.pathname.includes("/login"),s=e.config?.url?.includes("/auth/"),a=localStorage.getItem("auth-storage");t||s||!a||(localStorage.removeItem("auth-storage"),window.location.href="/login")}return Promise.reject(e)});let r=a,n={staffLogin:(e,t)=>a.post("/auth/login",{email:e,password:t}),sendOTP:e=>a.post("/auth/otp/send",{phone:e}),verifyOTP:(e,t)=>a.post("/auth/otp/verify",{phone:e,otp:t}),sendEmailOTP:e=>a.post("/auth/otp/email/send",{email:e}),verifyEmailOTP:(e,t)=>a.post("/auth/otp/email/verify",{email:e,otp:t}),sendMagicLink:e=>a.post("/auth/magic-link/send",{email:e}),verifyMagicLink:e=>a.get(`/auth/magic-link/verify/${e}`)},i={getAll:e=>a.get("/users",{params:e}),getOne:e=>a.get(`/users/${e}`),update:(e,t)=>a.put(`/users/${e}`,t),adjustPoints:(e,t,s)=>a.post(`/users/${e}/points`,{points:t,reason:s}),getStaticQR:e=>a.get(`/users/${e}/static-qr`),getVoucherInstances:(e,t)=>a.get(`/users/${e}/voucher-instances`,{params:t?{status:t}:void 0})},o={getAll:()=>a.get("/vouchers"),getAllAdmin:()=>a.get("/vouchers/all"),getOne:e=>a.get(`/vouchers/${e}`),create:e=>a.post("/vouchers",e),update:(e,t)=>a.patch(`/vouchers/${e}`,t),delete:e=>a.delete(`/vouchers/${e}`),redeem:(e,t)=>a.post(`/vouchers/${e}/redeem`,{user_id:t}),getInstances:(e,t)=>a.get(`/vouchers/instances/${e}`,{params:{status:t}})},l={earnPoints:(e,t,s)=>a.post("/transactions/earn",{user_id:e,amount:t,outlet:s}),redeemVoucher:(e,t,s)=>a.post("/transactions/redeem",{user_id:e,voucher_id:t,outlet:s}),getAll:e=>a.get("/transactions",{params:e})},c={getAll:e=>a.get("/announcements",{params:{user_type:e}}),getAllAdmin:()=>a.get("/announcements/all"),getById:e=>a.get(`/announcements/${e}`),create:e=>a.post("/announcements",e),update:(e,t)=>a.patch(`/announcements/${e}`,t),delete:e=>a.delete(`/announcements/${e}`)},d={getCredits:()=>a.get("/investors/credits"),getOutletCredits:e=>a.get(`/investors/credits/outlet/${e}`),getTransactions:e=>a.get("/investors/transactions",{params:e}),allocateOutletCredits:(e,t)=>a.post(`/investors/admin/${e}/outlet-credits`,t),allocateGroupCredits:(e,t)=>a.post(`/investors/admin/${e}/group-credits`,t),adjustCredits:(e,t)=>a.patch(`/investors/admin/${e}/credits/adjust`,t),getExpiringCredits:e=>a.get("/investors/admin/credits/expiring",{params:e?{days:e}:void 0})},u={getBudget:()=>a.get("/media/budget"),getTransactions:e=>a.get("/media/transactions",{params:e}),setBudget:(e,t)=>a.post(`/media/admin/${e}/budget`,t),adjustBudget:(e,t)=>a.patch(`/media/admin/${e}/budget/adjust`,t),getExpiringBudgets:e=>a.get("/media/admin/budgets/expiring",{params:e?{days:e}:void 0}),getUsageReport:()=>a.get("/media/admin/usage-report")},p={getAll:()=>a.get("/settings"),getOne:e=>a.get(`/settings/${e}`),update:(e,t)=>a.put(`/settings/${e}`,{value:t}),bulkUpdate:e=>a.put("/settings",{settings:e}),create:e=>a.post("/settings",e)},m={getVapidKey:()=>a.get("/notifications/vapid-public-key"),subscribe:e=>a.post("/notifications/subscribe",{subscription:e.toJSON()}),unsubscribe:e=>a.post("/notifications/unsubscribe",{endpoint:e}),getStatus:()=>a.get("/notifications/status"),getPreferences:()=>a.get("/notifications/preferences"),updatePreferences:e=>a.patch("/notifications/preferences",{preferences:e}),sendTest:()=>a.post("/notifications/test"),getHistory:e=>a.get("/notifications/history",{params:e}),adminSend:e=>a.post("/notifications/admin/send",e),adminBroadcast:e=>a.post("/notifications/admin/broadcast",e),adminStats:()=>a.get("/notifications/admin/stats"),adminProcessQueue:()=>a.post("/notifications/admin/process-queue")},g={getMyCode:()=>a.get("/referrals/my-code"),getMyReferrals:()=>a.get("/referrals/my-referrals"),validateCode:e=>a.get(`/referrals/validate/${e}`),applyCode:e=>a.post("/referrals/apply",e),getAdminStats:()=>a.get("/referrals/admin/stats")},h={getAll:()=>a.get("/pos/keys"),create:e=>a.post("/pos/keys",e),revoke:e=>a.delete(`/pos/keys/${e}`),getLogs:(e,t)=>a.get(`/pos/keys/${e}/logs`,{params:t}),getStats:()=>a.get("/pos/keys/stats")}},16205:(e,t,s)=>{s.d(t,{t:()=>n});var a=s(60114),r=s(85251);let n=(0,a.Ue)()((0,r.tJ)(e=>({user:null,token:null,hasHydrated:!1,setAuth:(t,s)=>{e({user:t,token:s})},logout:()=>{e({user:null,token:null})},updateUser:t=>{e(e=>e.user?{user:{...e.user,...t}}:e)},setHasHydrated:t=>{e({hasHydrated:t})}}),{name:"auth-storage",storage:(0,r.FL)(()=>localStorage),onRehydrateStorage:()=>e=>{e?.setHasHydrated(!0)}}))},48998:(e,t,s)=>{s.d(t,{Z:()=>a});let a=(0,s(76557).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])}};