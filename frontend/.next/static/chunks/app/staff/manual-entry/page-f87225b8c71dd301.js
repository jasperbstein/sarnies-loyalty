(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9016],{5007:function(e,t,r){Promise.resolve().then(r.bind(r,7413))},7413:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var s=r(7437),n=r(2265),a=r(9376),i=r(6189),l=r(6943),d=r(9116),c=r(4719),o=r(2252),h=r(6858),u=r(3581),x=r(5302),y=r(9064);function p(){let e=(0,a.useRouter)(),[t,r]=(0,n.useState)("input"),[p,m]=(0,n.useState)(""),[f,b]=(0,n.useState)(!1),[k,g]=(0,n.useState)(null),[v,j]=(0,n.useState)(""),w=async e=>{if(e.preventDefault(),p.trim()){b(!0),j("");try{let e;try{e=JSON.parse(p)}catch(t){e={token:p.trim()}}if("loyalty_id"!==e.type&&e.type){if("voucher_redemption"===e.type){if(!e.customer_id||!e.voucher_id)throw Error("Invalid voucher token: Missing required fields");let t=await d.ZP.get("/users/".concat(e.customer_id)),s=await d.ZP.get("/vouchers/".concat(e.voucher_id));g({type:"voucher_redemption",user:t.data,voucher:e,voucherDetails:s.data}),r("preview")}else throw Error("Unknown QR code type")}else{let t=e.customer_id||e.id;if(!t)throw Error("Invalid token: Missing customer ID");let s=await d.ZP.get("/users/".concat(t));g({type:"loyalty_id",user:s.data}),r("preview")}y.ZP.success("Token validated successfully")}catch(e){var t,s,n,a;j((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||e.message||"Invalid token"),r("error"),y.ZP.error((null===(a=e.response)||void 0===a?void 0:null===(n=a.data)||void 0===n?void 0:n.error)||e.message||"Invalid token")}finally{b(!1)}}},N=()=>{r("input"),m(""),g(null),j("")};return(0,s.jsx)(i.Z,{children:(0,s.jsxs)("div",{className:"max-w-3xl mx-auto space-y-6",children:[(0,s.jsxs)("div",{className:"bg-gradient-to-br from-gray-900 to-gray-800 rounded-2xl shadow-lg p-6 text-white",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,s.jsx)(c.Z,{className:"w-6 h-6"}),(0,s.jsx)("h2",{className:"text-2xl font-bold",children:"Manual QR Entry"})]}),(0,s.jsx)("p",{className:"text-gray-300",children:"Enter QR token manually when camera scanner is not available"})]}),"input"===t&&(0,s.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6 border border-gray-200",children:(0,s.jsxs)("form",{onSubmit:w,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"QR Code Token *"}),(0,s.jsx)("textarea",{className:"w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-black focus:border-black font-mono text-sm resize-none",rows:6,placeholder:"Paste or type QR token here...",value:p,onChange:e=>m(e.target.value),required:!0}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Accepts both JSON format and JWT tokens"})]}),(0,s.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"bg-blue-600 text-white rounded-full p-1 mt-0.5",children:(0,s.jsx)(o.Z,{className:"w-4 h-4"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Token Types"}),(0,s.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,s.jsxs)("li",{children:["• ",(0,s.jsx)("strong",{children:"Loyalty QR:"})," JWT token or JSON with customer_id"]}),(0,s.jsxs)("li",{children:["• ",(0,s.jsx)("strong",{children:"Voucher QR:"})," JSON with voucher_id and customer_id"]})]})]})]})}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{type:"submit",className:"flex-1 bg-black text-white py-4 rounded-xl font-bold hover:bg-gray-800 transition-all shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed",disabled:f||!p.trim(),children:f?(0,s.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,s.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Validating..."]}):(0,s.jsxs)("span",{className:"flex items-center justify-center gap-2",children:["Validate Token",(0,s.jsx)(h.Z,{className:"w-5 h-5"})]})}),(0,s.jsxs)("button",{type:"button",onClick:()=>e.push("/staff/scan"),className:"px-6 py-4 border-2 border-gray-300 text-gray-700 rounded-xl font-bold hover:bg-gray-50 transition-colors flex items-center gap-2",children:[(0,s.jsx)(u.Z,{className:"w-5 h-5"}),"Use Scanner"]})]})]})}),"preview"===t&&k&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-2xl p-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"bg-green-600 text-white rounded-full p-3",children:(0,s.jsx)(x.Z,{className:"w-6 h-6"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-green-900",children:"Token Validated"}),(0,s.jsx)("p",{className:"text-sm text-green-700",children:"QR code is valid and ready to process"})]})]})}),(0,s.jsx)(l.Z,{customer:k.user,qrType:k.type,showFullDetails:!0}),"voucher_redemption"===k.type&&k.voucherDetails&&(0,s.jsxs)("div",{className:"bg-purple-50 border border-purple-200 rounded-2xl p-6",children:[(0,s.jsx)("h4",{className:"font-bold text-purple-900 mb-3",children:"Voucher Information"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("p",{className:"text-sm text-purple-800",children:[(0,s.jsx)("strong",{children:"Title:"})," ",k.voucherDetails.title]}),(0,s.jsxs)("p",{className:"text-sm text-purple-800",children:[(0,s.jsx)("strong",{children:"Value:"})," ฿",Number(k.voucherDetails.cash_value).toFixed(2)]}),(0,s.jsxs)("p",{className:"text-sm text-purple-800",children:[(0,s.jsx)("strong",{children:"Points Cost:"})," ",k.voucherDetails.points_required]})]})]}),(0,s.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6 border border-gray-200",children:(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{onClick:()=>{e.push("/staff/scan")},className:"flex-1 bg-green-600 text-white py-4 rounded-xl font-bold hover:bg-green-700 transition-all shadow-sm hover:shadow-md",children:(0,s.jsxs)("span",{className:"flex items-center justify-center gap-2",children:["Proceed to ","loyalty_id"===k.type?"Add Points":"Redeem Voucher",(0,s.jsx)(h.Z,{className:"w-5 h-5"})]})}),(0,s.jsx)("button",{onClick:N,className:"px-6 py-4 border-2 border-gray-300 text-gray-700 rounded-xl font-bold hover:bg-gray-50 transition-colors",children:"Start Over"})]})})]}),"error"===t&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-red-50 border-2 border-red-200 rounded-2xl p-8 text-center",children:[(0,s.jsx)("div",{className:"bg-red-600 text-white rounded-full p-4 w-20 h-20 flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(o.Z,{className:"w-10 h-10"})}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-red-900 mb-2",children:"Invalid Token"}),(0,s.jsx)("p",{className:"text-red-700 mb-6",children:v}),(0,s.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-red-200 text-left",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-red-900 mb-2",children:"Common Issues:"}),(0,s.jsxs)("ul",{className:"text-sm text-red-800 space-y-1",children:[(0,s.jsx)("li",{children:"• Token is expired or malformed"}),(0,s.jsx)("li",{children:"• Customer ID does not exist"}),(0,s.jsx)("li",{children:"• Missing required fields in JSON"}),(0,s.jsx)("li",{children:"• Network connection error"})]})]})]}),(0,s.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6 border border-gray-200",children:(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{onClick:N,className:"flex-1 bg-black text-white py-4 rounded-xl font-bold hover:bg-gray-800 transition-all shadow-sm hover:shadow-md",children:"Try Again"}),(0,s.jsxs)("button",{onClick:()=>e.push("/staff/scan"),className:"px-6 py-4 border-2 border-gray-300 text-gray-700 rounded-xl font-bold hover:bg-gray-50 transition-colors flex items-center gap-2",children:[(0,s.jsx)(u.Z,{className:"w-5 h-5"}),"Use Scanner"]})]})})]})]})})}},2252:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},6858:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},3327:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]])},1047:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},3581:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},5302:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},7414:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]])},4719:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("Keyboard",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",ry:"2",key:"15u882"}],["path",{d:"M6 8h.001",key:"1ej0i3"}],["path",{d:"M10 8h.001",key:"1x2st2"}],["path",{d:"M14 8h.001",key:"1vkmyp"}],["path",{d:"M18 8h.001",key:"kfsenl"}],["path",{d:"M8 12h.001",key:"1sjpby"}],["path",{d:"M12 12h.001",key:"al75ts"}],["path",{d:"M16 12h.001",key:"931bgk"}],["path",{d:"M7 16h10",key:"wp8him"}]])},5466:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},7692:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},9345:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},3774:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},6439:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]])},6840:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]])},3041:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},1621:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]])},2369:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},5805:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},2489:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}},function(e){e.O(0,[1299,3464,368,3729,2971,2117,1744],function(){return e(e.s=5007)}),_N_E=e.O()}]);