(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8745],{9407:function(e,t,n){Promise.resolve().then(n.bind(n,4567))},4567:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return h}});var a=n(7437),r=n(2265),s=n(9376),c=n(3145),l=n(7209),i=n(2660),o=n(2720),u=n(1047),d=n(6444);function h(){(0,d.r)();let e=(0,s.useRouter)(),t=(0,s.useParams)(),[n,h]=(0,r.useState)(null),[m,x]=(0,r.useState)(!0),[p,f]=(0,r.useState)(!1);(0,r.useEffect)(()=>{y()},[t.id]);let y=async()=>{x(!0),f(!1);try{let e=await fetch("".concat("https://loyalty.sarnies.tech/api","/announcements/").concat(t.id));if(!e.ok)throw Error("Failed to fetch");let n=await e.json();h(n.announcement)}catch(e){f(!0)}finally{x(!1)}};return m?(0,a.jsx)(l.Z,{children:(0,a.jsxs)("div",{className:"pb-20 animate-pulse",children:[(0,a.jsx)("div",{className:"bg-gray-200 h-8 w-24 rounded mb-6"}),(0,a.jsx)("div",{className:"bg-gray-300 h-64 rounded-2xl mb-6"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"bg-gray-200 h-6 rounded"}),(0,a.jsx)("div",{className:"bg-gray-200 h-6 rounded w-3/4"}),(0,a.jsx)("div",{className:"bg-gray-200 h-6 rounded w-5/6"})]})]})}):p||!n?(0,a.jsx)(l.Z,{children:(0,a.jsxs)("div",{className:"pb-20",children:[(0,a.jsxs)("button",{onClick:()=>e.back(),className:"flex items-center gap-2 text-gray-600 hover:text-black mb-6 transition-colors",children:[(0,a.jsx)(i.Z,{className:"w-5 h-5"}),"Back"]}),(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-2xl p-8 text-center",children:[(0,a.jsx)("p",{className:"text-red-900 font-semibold mb-2",children:"Failed to load announcement"}),(0,a.jsx)("p",{className:"text-sm text-red-700 mb-4",children:"This announcement may no longer exist"}),(0,a.jsx)("button",{onClick:()=>e.push("/app/dashboard"),className:"bg-black hover:bg-gray-800 text-white px-6 py-2 rounded-xl text-sm font-medium transition-colors",children:"Go to Dashboard"})]})]})}):(0,a.jsx)(l.Z,{children:(0,a.jsxs)("div",{className:"pb-20",children:[(0,a.jsxs)("button",{onClick:()=>e.back(),className:"flex items-center gap-2 text-gray-600 hover:text-black mb-6 transition-colors font-medium",children:[(0,a.jsx)(i.Z,{className:"w-5 h-5"}),"Back"]}),(0,a.jsxs)("article",{className:"bg-white rounded-2xl overflow-hidden shadow-sm border border-gray-100",children:[n.image_url&&(0,a.jsx)("div",{className:"relative w-full aspect-[16/9] bg-gradient-to-br from-gray-100 to-gray-200",children:(0,a.jsx)(c.default,{src:n.image_url,alt:n.title,fill:!0,className:"object-cover",sizes:"100vw",priority:!0})}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-4 flex-wrap",children:[(0,a.jsxs)("span",{className:"text-xs font-semibold px-3 py-1.5 rounded-full ".concat((e=>{switch(e){case"promotion":return"bg-green-100 text-green-800";case"new_product":return"bg-blue-100 text-blue-800";case"seasonal":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}})(n.announcement_type)),children:[(0,a.jsx)(o.Z,{className:"w-3 h-3 inline mr-1"}),(e=>{switch(e){case"promotion":return"Promotion";case"new_product":return"New Product";case"seasonal":return"Seasonal";case"news":return"News";default:return"Announcement"}})(n.announcement_type)]}),(0,a.jsxs)("span",{className:"text-xs text-gray-500 flex items-center gap-1",children:[(0,a.jsx)(u.Z,{className:"w-3 h-3"}),new Date(n.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})]})]}),(0,a.jsx)("h1",{className:"text-heading text-black mb-4",children:n.title}),(0,a.jsx)("div",{className:"text-body text-gray-700 whitespace-pre-wrap mb-6",children:(e=>{let t=/(https?:\/\/[^\s]+)/g;return e.split(t).map((e,n)=>e.match(t)?(0,a.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 underline break-all",children:e},n):(0,a.jsx)("span",{children:e},n))})(n.description)}),n.cta_text&&n.cta_link&&(0,a.jsx)("button",{onClick:()=>{(null==n?void 0:n.cta_link)&&(n.cta_link.startsWith("/")||n.cta_link.startsWith("#")?e.push(n.cta_link):window.open(n.cta_link,"_blank"))},className:"btn-primary w-full",children:n.cta_text})]})]})]})})}},7209:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var a=n(7437),r=n(9376),s=n(2097),c=n(9637),l=n(5080),i=n(5621),o=n(2369),u=n(7692),d=n(2265);function h(e){let{children:t,hideLogout:n=!1}=e,h=(0,r.useRouter)(),m=(0,r.usePathname)(),{user:x,logout:p}=(0,s.t)(),[f,y]=(0,d.useState)(!1);(0,d.useEffect)(()=>{y(!0)},[]);let b=e=>!!e&&("customer"===e.type||"staff"===e.type||"customer"===e.user_type||"employee"===e.user_type||"staff"===e.user_type);if((0,d.useEffect)(()=>{f&&!b(x)&&h.push("/login")},[x,h,f]),!f)return(0,a.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-6 h-6 border-2 border-black border-t-transparent rounded-full animate-spin"})});if(!b(x))return null;let v=[{icon:c.Z,label:"HOME",path:"/app/home"},{icon:l.Z,label:"VOUCHERS",path:"/app/vouchers"},{icon:i.Z,label:"HISTORY",path:"/app/activity"},{icon:o.Z,label:"PROFILE",path:"/app/profile"}];return(0,a.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,a.jsx)("header",{className:"fixed top-0 left-0 right-0 h-header bg-black z-fixed",children:(0,a.jsxs)("div",{className:"h-full max-w-container mx-auto px-6 flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-label text-white",children:"SARNIES"}),!n&&(0,a.jsx)("button",{onClick:()=>{confirm("Are you sure you want to log out?")&&(p(),h.push("/login"))},className:"p-2.5 -mr-2.5 text-white/60 hover:text-white transition-opacity","aria-label":"Log out",type:"button",children:(0,a.jsx)(u.Z,{className:"w-[18px] h-[18px]",strokeWidth:1.5})})]})}),(0,a.jsx)("main",{className:"pt-header pb-[calc(var(--nav-height)+env(safe-area-inset-bottom,0px)+16px)] min-h-screen",children:(0,a.jsx)("div",{className:"max-w-container mx-auto px-5 py-6",children:t})}),(0,a.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-fixed pb-safe",children:(0,a.jsx)("div",{className:"max-w-container mx-auto px-4",children:(0,a.jsx)("div",{className:"flex justify-around items-start h-[60px] pt-2.5",children:v.map(e=>{let t=e.icon,n=m===e.path||m.startsWith(e.path);return(0,a.jsxs)("button",{onClick:()=>h.push(e.path),className:"flex flex-col items-center justify-start min-w-[64px] py-1 transition-all active:scale-95",children:[(0,a.jsxs)("div",{className:"relative mb-1",children:[(0,a.jsx)(t,{className:"w-[22px] h-[22px] transition-colors ".concat(n?"text-black stroke-[2]":"text-gray-400 stroke-[1.5]")}),n&&(0,a.jsx)("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-1 h-1 rounded-full ".concat((null==x?void 0:x.user_type)==="employee"?"bg-mustard":"bg-accent")})]}),(0,a.jsx)("span",{className:"text-nav ".concat(n?"text-black":"text-gray-400"),children:e.label})]},e.path)})})})})]})}},6444:function(e,t,n){"use strict";n.d(t,{r:function(){return s}});var a=n(2265),r=n(9376);let s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{enabled:t=!0,threshold:n=100,edgeWidth:s=50}=e,c=(0,r.useRouter)(),l=(0,a.useRef)(0),i=(0,a.useRef)(0),o=(0,a.useRef)(!1);(0,a.useEffect)(()=>{if(!t)return;let e=e=>{let t=e.touches[0];l.current=t.clientX,i.current=t.clientY,o.current=t.clientX<s},a=e=>{if(!o.current)return;let t=e.touches[0],a=t.clientX-l.current,r=Math.abs(t.clientY-i.current);a>n&&a>2*r&&e.preventDefault()},r=e=>{if(!o.current)return;let t=e.changedTouches[0],a=t.clientX-l.current,r=Math.abs(t.clientY-i.current);a>n&&a>2*r&&c.back(),o.current=!1};return document.addEventListener("touchstart",e,{passive:!0}),document.addEventListener("touchmove",a,{passive:!1}),document.addEventListener("touchend",r),()=>{document.removeEventListener("touchstart",e),document.removeEventListener("touchmove",a),document.removeEventListener("touchend",r)}},[t,n,s,c])}},2097:function(e,t,n){"use strict";n.d(t,{t:function(){return s}});var a=n(9625),r=n(6885);let s=(0,a.Ue)()((0,r.tJ)(e=>({user:null,token:null,hasHydrated:!1,setAuth:(t,n)=>{e({user:t,token:n})},logout:()=>{e({user:null,token:null})},updateUser:t=>{e(e=>e.user?{user:{...e.user,...t}}:e)},setHasHydrated:t=>{e({hasHydrated:t})}}),{name:"auth-storage",storage:(0,r.FL)(()=>localStorage),onRehydrateStorage:()=>e=>{null==e||e.setHasHydrated(!0)}}))},9763:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var a=n(2265),r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),c=(e,t)=>{let n=(0,a.forwardRef)((n,c)=>{let{color:l="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:u,className:d="",children:h,...m}=n;return(0,a.createElement)("svg",{ref:c,...r,width:i,height:i,stroke:l,strokeWidth:u?24*Number(o)/Number(i):o,className:["lucide","lucide-".concat(s(e)),d].join(" "),...m},[...t.map(e=>{let[t,n]=e;return(0,a.createElement)(t,n)}),...Array.isArray(h)?h:[h]])});return n.displayName="".concat(e),n}},2660:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1047:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(9763).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},5621:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(9763).Z)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]])},9637:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(9763).Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]])},7692:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(9763).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},2720:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(9763).Z)("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]])},5080:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(9763).Z)("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]])},2369:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(9763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])}},function(e){e.O(0,[1299,3145,2971,2117,1744],function(){return e(e.s=9407)}),_N_E=e.O()}]);