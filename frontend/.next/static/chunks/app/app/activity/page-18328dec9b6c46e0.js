(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[104],{5245:function(e,t,s){Promise.resolve().then(s.bind(s,3060))},3060:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var r=s(7437),a=s(2265),n=s(1994);let l=e=>{let{label:t,active:s,onClick:a}=e;return(0,r.jsx)("button",{type:"button",onClick:a,className:(0,n.Z)("h-[32px] px-4 rounded-full border text-[14px] font-medium transition-colors",s?"border-[#D5A253] bg-[#FFF6E8] text-[#1B1B1B]":"border-[#E5E7EB] bg-white text-[#1B1B1B] hover:bg-[#F7F7F7]"),children:t})},i=e=>{let{value:t,onChange:s}=e,a={all:"All",earned:"Earned",redeemed:"Redeemed",used:"Used",expired:"Expired"};return(0,r.jsx)("div",{className:"flex flex-wrap gap-8 items-center mt-4",children:(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:["all","earned","redeemed","used","expired"].map(e=>(0,r.jsx)(l,{label:a[e],active:t===e,onClick:()=>s(e)},e))})})},c=a.forwardRef(function(e,t){let{title:s,titleId:r,...n}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"}))}),d=e=>{let{title:t,description:s,icon:a}=e;return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-full bg-[#FFF6E8] flex items-center justify-center text-[#D5A253]",children:a||(0,r.jsx)(c,{className:"w-6 h-6"})}),(0,r.jsx)("h3",{className:"mt-4 text-[18px] font-semibold text-[#1B1B1B]",children:t}),(0,r.jsx)("p",{className:"mt-1 text-[14px] text-[#6F6F6F] max-w-xs",children:s})]})};var o=s(7209),u=s(9347),x=s(2097),h=s(9116),m=s(3145),p=s(5302),f=s(5131),g=s(1723);function y(e){let{title:t,description:s,image_url:a,computed_status:n,redeemed_at:l,used_at:i,expires_at:c,onClick:d}=e,o="active"===n;return(0,r.jsxs)("div",{onClick:o?d:void 0,className:"relative rounded-2xl overflow-hidden transition-all ".concat(o?"bg-white border-2 border-green-500 shadow-md hover:shadow-lg cursor-pointer transform hover:scale-[1.02]":"bg-gray-100 border-2 border-gray-300 opacity-60 cursor-not-allowed"),children:[(0,r.jsxs)("div",{className:"flex gap-4 p-4",children:[(0,r.jsx)("div",{className:"relative w-20 h-20 flex-shrink-0 rounded-xl overflow-hidden bg-gray-200",children:a?(0,r.jsx)(m.default,{src:a,alt:t,fill:!0,className:"object-cover ".concat(o?"":"grayscale")}):(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center ".concat(o?"bg-green-100":"bg-gray-300"),children:(0,r.jsx)(g.Z,{className:"w-8 h-8 ".concat(o?"text-green-600":"text-gray-500")})})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-2",children:[(0,r.jsx)("h3",{className:"font-bold text-base ".concat(o?"text-gray-900":"text-gray-600"),children:t}),(()=>{switch(n){case"active":return(0,r.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-green-100 text-green-800 text-xs font-semibold rounded-full",children:[(0,r.jsx)(p.Z,{className:"w-3 h-3"}),"Ready to Use"]});case"used":return(0,r.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-gray-100 text-gray-600 text-xs font-semibold rounded-full",children:[(0,r.jsx)(p.Z,{className:"w-3 h-3"}),"Used"]});case"expired":return(0,r.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-red-100 text-red-600 text-xs font-semibold rounded-full",children:[(0,r.jsx)(f.Z,{className:"w-3 h-3"}),"Expired"]})}})()]}),(0,r.jsx)("p",{className:"text-sm mb-2 line-clamp-2 ".concat(o?"text-gray-600":"text-gray-500"),children:s}),(0,r.jsxs)("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[(0,r.jsx)(g.Z,{className:"w-3 h-3"}),(0,r.jsx)("span",{children:i?"Used on ".concat(new Date(i).toLocaleDateString()):"expired"===n&&c?"Expired on ".concat(new Date(c).toLocaleDateString()):c?"Expires ".concat(new Date(c).toLocaleDateString()):"Redeemed ".concat(new Date(l).toLocaleDateString())})]})]})]}),o&&(0,r.jsx)("div",{className:"absolute top-0 right-0 w-0 h-0 border-t-[40px] border-r-[40px] border-t-green-500 border-r-transparent",children:(0,r.jsx)("div",{className:"absolute -top-9 -right-1 text-white text-xs font-bold transform rotate-45",children:"✓"})})]})}var v=s(978),b=s(9064);function j(){let[e,t]=(0,a.useState)("all"),{user:s,hasHydrated:n}=(0,x.t)(),[l,c]=(0,a.useState)(!1),[m,f]=(0,a.useState)([]),[j,N]=(0,a.useState)(!0),[w,k]=(0,a.useState)(!1),[Z,E]=(0,a.useState)(null);(0,u.h)(),(0,a.useEffect)(()=>{c(!0)},[]),(0,a.useEffect)(()=>{s&&l&&n&&_()},[s,l,n,e]);let _=async()=>{if(s){N(!0);try{let t="all"===e?void 0:e,r=await h.h3.getVoucherInstances(s.id,t);f(r.data.voucher_instances)}catch(e){b.ZP.error("Failed to load voucher history")}finally{N(!1)}}},F=e=>{"active"===e.computed_status&&(E(e),k(!0))};if(!l||!n)return(0,r.jsx)(o.Z,{children:(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsx)("div",{className:"w-8 h-8 border-4 border-black border-t-transparent rounded-full animate-spin"})})});let L=(null==s?void 0:s.user_type)==="employee",S=m.reduce((e,t)=>(e[t.computed_status]=(e[t.computed_status]||0)+1,e),{}),B=Object.keys(S).length>1;return(0,r.jsxs)(o.Z,{children:[(0,r.jsxs)("div",{className:"flex flex-col gap-6 pb-24",children:[(0,r.jsxs)("header",{children:[(0,r.jsx)("h1",{className:"text-[24px] font-semibold text-[#1B1B1B]",children:L?"Redemption History":"Activity History"}),(0,r.jsx)("p",{className:"text-[14px] text-[#6F6F6F] mt-1",children:L?"Your daily drink redemption history.":"Your points and voucher history."}),!L&&(0,r.jsxs)("div",{className:"mt-3 inline-flex items-center px-4 py-2 rounded-full bg-[#FFF6E8] text-[14px] text-[#8B6F36]",children:["⭐ ",(0,r.jsxs)("span",{className:"ml-2",children:[(null==s?void 0:s.points_balance)||0," points remaining"]})]})]}),!L&&!j&&m.length>0&&(0,r.jsx)(i,{value:e,onChange:t}),L&&!j&&m.length>0&&B&&(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("button",{onClick:()=>t("all"),className:"px-4 py-2 rounded-full text-sm font-medium transition-colors ".concat("all"===e?"bg-black text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["All (",m.length,")"]}),S.active>0&&(0,r.jsxs)("button",{onClick:()=>t("active"),className:"px-4 py-2 rounded-full text-sm font-medium transition-colors ".concat("active"===e?"bg-black text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["Active (",S.active,")"]}),S.used>0&&(0,r.jsxs)("button",{onClick:()=>t("used"),className:"px-4 py-2 rounded-full text-sm font-medium transition-colors ".concat("used"===e?"bg-black text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:["Used (",S.used,")"]})]}),j?(0,r.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,r.jsx)("div",{className:"w-8 h-8 border-4 border-black border-t-transparent rounded-full animate-spin"})}):0===m.length?(0,r.jsx)(d,{title:L?"No redemptions yet":"No activity yet",description:"all"===e?L?"Your daily drink redemptions will appear here.":"Your vouchers will appear here after redemption.":"No ".concat(e," ").concat(L?"redemptions":"vouchers"," found.")}):L?(0,r.jsx)("div",{className:"space-y-6",children:Object.entries(m.reduce((e,t)=>{let s=new Date(t.redeemed_at).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return e[s]||(e[s]=[]),e[s].push(t),e},{})).map(e=>{let[t,s]=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-3",children:t}),(0,r.jsx)("div",{className:"space-y-3",children:s.map(e=>(0,r.jsxs)("div",{className:"bg-white rounded-xl p-4 border border-gray-200",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,r.jsx)("h4",{className:"font-bold text-gray-900",children:e.title}),(0,r.jsx)("span",{className:"text-xs font-semibold px-2 py-1 rounded-full ".concat("used"===e.computed_status?"bg-gray-100 text-gray-600":"bg-green-100 text-green-700"),children:"used"===e.computed_status?"Used":"Active"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(g.Z,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:new Date(e.redeemed_at).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})})]}),e.used_at&&(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(p.Z,{className:"w-4 h-4"}),(0,r.jsxs)("span",{children:["Used at ",new Date(e.used_at).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})]})]})]})]},e.id))}),(0,r.jsxs)("div",{className:"mt-2 text-right text-sm text-gray-500",children:[(0,r.jsx)("span",{className:"font-semibold",children:s.length})," redemption",1!==s.length?"s":""," on this day"]})]},t)})}):(0,r.jsx)("div",{className:"space-y-3",children:m.map(e=>(0,r.jsx)(y,{...e,onClick:()=>F(e)},e.id))})]}),Z&&(0,r.jsx)(v.Z,{isOpen:w,onClose:()=>{k(!1),E(null)},title:Z.title,qrDataUrl:Z.qr_code_data,expiresAt:Z.expires_at})]})}},9347:function(e,t,s){"use strict";s.d(t,{h:function(){return l}});var r=s(2265),a=s(9376);let n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{onSwipeLeft:t,onSwipeRight:s,threshold:a=50}=e,n=(0,r.useRef)(0),l=(0,r.useRef)(0);(0,r.useEffect)(()=>{let e=e=>{n.current=e.changedTouches[0].screenX},r=e=>{l.current=e.changedTouches[0].screenX,i()},i=()=>{let e=n.current-l.current;Math.abs(e)<a||(e>0?null==t||t():null==s||s())};return document.addEventListener("touchstart",e),document.addEventListener("touchend",r),()=>{document.removeEventListener("touchstart",e),document.removeEventListener("touchend",r)}},[t,s,a])},l=()=>{let e=(0,a.useRouter)(),t=["/app/home","/app/rewards","/app/activity","/app/profile"],s=()=>{let e=window.location.pathname,s=t.findIndex(t=>e.includes(t));return s>=0?s:0},r=r=>{let a;let n=s();(a="left"===r?Math.min(n+1,t.length-1):Math.max(n-1,0))!==n&&e.push(t[a])};n({onSwipeLeft:()=>r("left"),onSwipeRight:()=>r("right"),threshold:75})}},5302:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},5621:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]])},9637:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]])},7692:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},5080:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]])},2369:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},5131:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(9763).Z)("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},1994:function(e,t,s){"use strict";t.Z=function(){for(var e,t,s=0,r="",a=arguments.length;s<a;s++)(e=arguments[s])&&(t=function e(t){var s,r,a="";if("string"==typeof t||"number"==typeof t)a+=t;else if("object"==typeof t){if(Array.isArray(t)){var n=t.length;for(s=0;s<n;s++)t[s]&&(r=e(t[s]))&&(a&&(a+=" "),a+=r)}else for(r in t)t[r]&&(a&&(a+=" "),a+=r)}return a}(e))&&(r&&(r+=" "),r+=t);return r}}},function(e){e.O(0,[1299,3464,368,3145,2336,2971,2117,1744],function(){return e(e.s=5245)}),_N_E=e.O()}]);