(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[214],{7439:function(e,t,a){Promise.resolve().then(a.bind(a,1782))},1782:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var s=a(7437),r=a(2265),n=a(9376),l=a(6189),i=a(3404),d=a(4392),o=a(9397);let c=(0,a(9763).Z)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);function u(e){let{isOpen:t,onClose:a,currentBalance:n,userName:l,onAdjust:u}=e,[x,m]=(0,r.useState)(""),[p,b]=(0,r.useState)(""),[h,g]=(0,r.useState)(""),[f,j]=(0,r.useState)(!1),[v,y]=(0,r.useState)("add"),N=parseInt(x)||0,w="deduct"===v?-N:N,_=n+w,k=async e=>{if(e.preventDefault(),x&&0!==N&&p.trim()){j(!0);try{await u(w,p,h||void 0),m(""),b(""),g(""),y("add"),a()}catch(e){}finally{j(!1)}}};return(0,s.jsx)(i.Z,{isOpen:t,onClose:a,title:"Adjust Points Balance",size:"md",children:(0,s.jsxs)("form",{onSubmit:k,className:"space-y-6",children:[(0,s.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Adjusting points for"}),(0,s.jsx)("p",{className:"text-lg font-bold text-gray-900 mt-1",children:l}),(0,s.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-600",children:"Current Balance"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:n})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-600",children:"New Balance"}),(0,s.jsx)("p",{className:"text-2xl font-bold ".concat(_<0?"text-red-600":"text-green-600"),children:_})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Action"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("button",{type:"button",onClick:()=>y("add"),className:"flex items-center justify-center gap-2 px-4 py-3 rounded-lg font-medium transition-all ".concat("add"===v?"bg-green-600 text-white shadow-sm":"bg-white text-gray-700 border-2 border-gray-300 hover:bg-gray-50"),children:[(0,s.jsx)(o.Z,{size:20}),"Add Points"]}),(0,s.jsxs)("button",{type:"button",onClick:()=>y("deduct"),className:"flex items-center justify-center gap-2 px-4 py-3 rounded-lg font-medium transition-all ".concat("deduct"===v?"bg-red-600 text-white shadow-sm":"bg-white text-gray-700 border-2 border-gray-300 hover:bg-gray-50"),children:[(0,s.jsx)(c,{size:20}),"Deduct Points"]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Amount ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("input",{type:"number",min:"1",value:x,onChange:e=>m(e.target.value),placeholder:"Enter points amount",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg font-semibold",required:!0}),N>0&&(0,s.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:["add"===v?"+":"-",N," points"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Reason ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("input",{type:"text",value:p,onChange:e=>b(e.target.value),placeholder:"e.g., Compensation for service issue",className:"w-full px-4 py-2.5 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Internal Note (Optional)"}),(0,s.jsx)("textarea",{value:h,onChange:e=>g(e.target.value),placeholder:"Add any additional context for internal records...",rows:3,className:"w-full px-4 py-2.5 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[(0,s.jsx)(d.Z,{type:"button",variant:"secondary",onClick:a,disabled:f,children:"Cancel"}),(0,s.jsxs)(d.Z,{type:"submit",variant:"deduct"===v?"destructive":"primary",loading:f,disabled:!x||!p.trim(),children:["add"===v?"Add":"Deduct"," ",N>0?N:""," Points"]})]})]})})}var x=a(9116),m=a(2660),p=a(3041),b=a(8226),h=a(9064);function g(){let e=(0,n.useRouter)(),t=(0,n.useParams)(),a=Number(t.id),[i,d]=(0,r.useState)(null),[g,f]=(0,r.useState)([]),[j,v]=(0,r.useState)([]),[y,N]=(0,r.useState)([]),[w,_]=(0,r.useState)(!0),[k,A]=(0,r.useState)(!1),[C,S]=(0,r.useState)(!1),[B,D]=(0,r.useState)(!1),[Z,F]=(0,r.useState)({outletId:"",annualAllocation:"",creditsBalance:"",autoRenew:!0,expiresAt:""}),[P,E]=(0,r.useState)({enabled:!1,annualAllocation:"",creditsBalance:"",autoRenew:!0,expiresAt:""}),[R,z]=(0,r.useState)(!1),[L,I]=(0,r.useState)({annualBudget:"",expiresAt:""});(0,r.useEffect)(()=>{O(),q()},[t.id]);let O=async()=>{try{_(!0);let e=(await x.h3.getOne(a)).data;if(d(e),"investor"===e.user_type)try{let t=await fetch("/api/outlets");if(t.ok){let e=await t.json();v(e)}let a=await x.Vj.getCredits();a.data&&N(a.data.outletCredits||[]),e.investor_group_credits_allocation>0&&E({enabled:!0,annualAllocation:e.investor_group_credits_allocation.toString(),creditsBalance:(e.investor_group_credits_balance||0).toString(),autoRenew:!1!==e.investor_group_credits_auto_renew,expiresAt:e.investor_group_credits_expires_at?new Date(e.investor_group_credits_expires_at).toISOString().split("T")[0]:""})}catch(e){}"media"===e.user_type&&I({annualBudget:(e.media_annual_budget||0).toString(),expiresAt:e.media_budget_expires_at?new Date(e.media_budget_expires_at).toISOString().split("T")[0]:""})}catch(t){h.ZP.error("Failed to load user"),e.back()}finally{_(!1)}},q=async()=>{try{let e=await x.L2.getAll({user_id:a,limit:50});f(e.data.transactions||[])}catch(e){}},M=async(e,t)=>{try{await x.h3.adjustPoints(a,e,t),h.ZP.success("Points adjusted successfully"),A(!1),O(),q()}catch(e){var s,r;h.ZP.error((null===(r=e.response)||void 0===r?void 0:null===(s=r.data)||void 0===s?void 0:s.error)||"Failed to adjust points")}},U=async e=>{e.preventDefault();try{await x.Vj.allocateOutletCredits(a,{outletId:parseInt(Z.outletId),annualAllocation:parseInt(Z.annualAllocation),creditsBalance:parseInt(Z.creditsBalance),autoRenew:Z.autoRenew,expiresAt:Z.expiresAt||void 0}),h.ZP.success("Outlet credits allocated successfully"),S(!1),F({outletId:"",annualAllocation:"",creditsBalance:"",autoRenew:!0,expiresAt:""}),O()}catch(e){var t,s;h.ZP.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Failed to allocate outlet credits")}},G=async e=>{e.preventDefault();try{await x.Vj.allocateGroupCredits(a,{enabled:!0,annualAllocation:parseInt(P.annualAllocation),creditsBalance:parseInt(P.creditsBalance),expiresAt:P.expiresAt||void 0}),h.ZP.success("Group credits allocated successfully"),D(!1),O()}catch(e){var t,s;h.ZP.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Failed to allocate group credits")}},T=async e=>{e.preventDefault();try{await x.nN.setBudget(a,{annualBudgetThb:parseFloat(L.annualBudget),expiresAt:L.expiresAt||void 0}),h.ZP.success("Media budget set successfully"),z(!1),O()}catch(e){var t,s;h.ZP.error((null===(s=e.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.error)||"Failed to set media budget")}};return w?(0,s.jsx)(l.Z,{children:(0,s.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,s.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),(0,s.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})}):i?(0,s.jsxs)(l.Z,{children:[(0,s.jsx)("div",{className:"min-h-screen bg-neutral-50",children:(0,s.jsxs)("div",{className:"max-w-[1600px] mx-auto px-6 py-8",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("button",{onClick:()=>e.back(),className:"flex items-center gap-1.5 text-neutral-600 hover:text-neutral-900 transition-colors mb-4 leading-none",children:[(0,s.jsx)(m.Z,{size:14}),(0,s.jsx)("span",{className:"text-[12px] font-medium",children:"Back to Users"})]}),(0,s.jsxs)("h1",{className:"text-[28px] font-semibold text-neutral-900",children:[i.name," ",i.surname]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 mt-2",children:[(0,s.jsxs)("span",{className:"flex items-center gap-1.5 text-[14px] text-neutral-500",children:[(0,s.jsx)(p.Z,{size:13}),i.phone]}),i.company&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-neutral-300",children:"•"}),(0,s.jsx)("span",{className:"text-[14px] text-neutral-500",children:i.company})]}),(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-[11px] font-medium ".concat("investor"===i.user_type?"bg-[#F7EDD4] text-[#8B6914]":"media"===i.user_type?"bg-[#D7E7FF] text-[#1E40AF]":"employee"===i.user_type?"bg-[#EAE7FF] text-[#5B21B6]":"bg-[#F3F3F3] text-neutral-700"),children:i.user_type})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[(0,s.jsxs)("div",{className:"bg-white border border-neutral-200 rounded-lg p-4 shadow-sm",children:[(0,s.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-wide text-neutral-500 mb-2",children:"Points Balance"}),(0,s.jsx)("p",{className:"text-[32px] font-bold text-neutral-900 mb-1",children:i.points_balance.toLocaleString()}),(0,s.jsx)("button",{onClick:()=>A(!0),className:"text-[12px] font-medium text-neutral-900 hover:text-neutral-700 transition-colors",children:"Adjust →"})]}),(0,s.jsxs)("div",{className:"bg-white border border-neutral-200 rounded-lg p-4 shadow-sm",children:[(0,s.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-wide text-neutral-500 mb-2",children:"Total Spent"}),(0,s.jsxs)("p",{className:"text-[32px] font-bold text-neutral-900",children:["฿","number"==typeof i.total_spend?i.total_spend.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"]})]}),(0,s.jsxs)("div",{className:"bg-white border border-neutral-200 rounded-lg p-4 shadow-sm",children:[(0,s.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-wide text-neutral-500 mb-2",children:"Purchases"}),(0,s.jsx)("p",{className:"text-[32px] font-bold text-neutral-900",children:(i.total_purchases_count||0).toLocaleString()})]}),(0,s.jsxs)("div",{className:"bg-white border border-neutral-200 rounded-lg p-4 shadow-sm",children:[(0,s.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-wide text-neutral-500 mb-2",children:"Member Since"}),(0,s.jsx)("p",{className:"text-[20px] font-bold text-neutral-900",children:new Date(i.created_at).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})})]})]}),("investor"===i.user_type||"media"===i.user_type)&&(0,s.jsxs)("div",{className:"bg-white border border-neutral-200 rounded-lg shadow-sm mb-6",children:[(0,s.jsx)("div",{className:"px-6 py-4 border-b border-neutral-200",children:(0,s.jsx)("h3",{className:"text-[14px] font-semibold text-neutral-900",children:"Credits & Budget"})}),"investor"===i.user_type&&(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h4",{className:"text-[13px] font-semibold text-neutral-700",children:"Group Credits (All Outlets)"}),(0,s.jsxs)("button",{onClick:()=>D(!B),className:"text-[12px] font-medium text-neutral-900 hover:text-neutral-700 transition-colors",children:[P.enabled?"Update":"Enable"," →"]})]}),P.enabled&&!B&&(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-[11px] font-semibold uppercase tracking-wide text-neutral-500 mb-1.5 block",children:"Current Balance"}),(0,s.jsx)("p",{className:"text-[24px] font-bold text-neutral-900",children:i.investor_group_credits_balance||0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-[11px] font-semibold uppercase tracking-wide text-neutral-500 mb-1.5 block",children:"Annual Allocation"}),(0,s.jsx)("p",{className:"text-[24px] font-bold text-neutral-900",children:i.investor_group_credits_allocation||0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-[11px] font-semibold uppercase tracking-wide text-neutral-500 mb-1.5 block",children:"Auto Renew"}),(0,s.jsx)("p",{className:"text-[18px] font-semibold text-neutral-900",children:i.investor_group_credits_auto_renew?"Yes":"No"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-[11px] font-semibold uppercase tracking-wide text-neutral-500 mb-1.5 block",children:"Expires At"}),(0,s.jsx)("p",{className:"text-[18px] font-semibold text-neutral-900",children:i.investor_group_credits_expires_at?new Date(i.investor_group_credits_expires_at).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}):"N/A"})]})]}),B&&(0,s.jsxs)("form",{onSubmit:G,className:"space-y-3 bg-neutral-50 p-4 rounded-lg",children:[(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-[12px] font-medium text-neutral-700 mb-1",children:"Annual Allocation"}),(0,s.jsx)("input",{type:"number",value:P.annualAllocation,onChange:e=>E({...P,annualAllocation:e.target.value}),className:"w-full px-3 py-2 text-[13px] border border-neutral-300 rounded-lg focus:ring-2 focus:ring-neutral-900 focus:border-transparent",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-[12px] font-medium text-neutral-700 mb-1",children:"Current Balance"}),(0,s.jsx)("input",{type:"number",value:P.creditsBalance,onChange:e=>E({...P,creditsBalance:e.target.value}),className:"w-full px-3 py-2 text-[13px] border border-neutral-300 rounded-lg focus:ring-2 focus:ring-neutral-900 focus:border-transparent",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-[12px] font-medium text-neutral-700 mb-1",children:"Expires At"}),(0,s.jsx)("input",{type:"date",value:P.expiresAt,onChange:e=>E({...P,expiresAt:e.target.value}),className:"w-full px-3 py-2 text-[13px] border border-neutral-300 rounded-lg focus:ring-2 focus:ring-neutral-900 focus:border-transparent"})]}),(0,s.jsx)("div",{className:"flex items-end",children:(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:P.autoRenew,onChange:e=>E({...P,autoRenew:e.target.checked}),className:"w-4 h-4"}),(0,s.jsx)("span",{className:"text-[12px] font-medium text-neutral-700",children:"Auto Renew"})]})})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{type:"submit",className:"bg-neutral-900 text-white px-4 py-2 rounded-lg text-[13px] font-medium hover:bg-neutral-800 transition-colors",children:"Save Group Credits"}),(0,s.jsx)("button",{type:"button",onClick:()=>D(!1),className:"bg-white border border-neutral-300 text-neutral-900 px-4 py-2 rounded-lg text-[13px] font-medium hover:bg-neutral-50 transition-colors",children:"Cancel"})]})]})]}),(0,s.jsxs)("div",{className:"pt-6 border-t border-neutral-200",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h4",{className:"text-[13px] font-semibold text-neutral-700",children:"Outlet-Specific Credits"}),(0,s.jsx)("button",{onClick:()=>S(!C),className:"text-[12px] font-medium text-neutral-900 hover:text-neutral-700 transition-colors",children:"Add Outlet →"})]}),C&&(0,s.jsxs)("form",{onSubmit:U,className:"mb-4 p-4 bg-neutral-50 rounded-lg space-y-3",children:[(0,s.jsxs)("div",{className:"grid grid-cols-5 gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-[12px] font-medium text-neutral-700 mb-1",children:"Outlet"}),(0,s.jsxs)("select",{value:Z.outletId,onChange:e=>F({...Z,outletId:e.target.value}),className:"w-full px-3 py-2 text-[13px] border border-neutral-300 rounded-lg focus:ring-2 focus:ring-neutral-900 focus:border-transparent",required:!0,children:[(0,s.jsx)("option",{value:"",children:"Select outlet..."}),j.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-[12px] font-medium text-neutral-700 mb-1",children:"Annual Allocation"}),(0,s.jsx)("input",{type:"number",value:Z.annualAllocation,onChange:e=>F({...Z,annualAllocation:e.target.value}),className:"w-full px-3 py-2 text-[13px] border border-neutral-300 rounded-lg focus:ring-2 focus:ring-neutral-900 focus:border-transparent",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-[12px] font-medium text-neutral-700 mb-1",children:"Current Balance"}),(0,s.jsx)("input",{type:"number",value:Z.creditsBalance,onChange:e=>F({...Z,creditsBalance:e.target.value}),className:"w-full px-3 py-2 text-[13px] border border-neutral-300 rounded-lg focus:ring-2 focus:ring-neutral-900 focus:border-transparent",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-[12px] font-medium text-neutral-700 mb-1",children:"Expires At"}),(0,s.jsx)("input",{type:"date",value:Z.expiresAt,onChange:e=>F({...Z,expiresAt:e.target.value}),className:"w-full px-3 py-2 text-[13px] border border-neutral-300 rounded-lg focus:ring-2 focus:ring-neutral-900 focus:border-transparent"})]}),(0,s.jsx)("div",{className:"flex items-end",children:(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:Z.autoRenew,onChange:e=>F({...Z,autoRenew:e.target.checked}),className:"w-4 h-4"}),(0,s.jsx)("span",{className:"text-[12px] font-medium text-neutral-700",children:"Auto Renew"})]})})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{type:"submit",className:"bg-neutral-900 text-white px-4 py-2 rounded-lg text-[13px] font-medium hover:bg-neutral-800 transition-colors",children:"Allocate Credits"}),(0,s.jsx)("button",{type:"button",onClick:()=>S(!1),className:"bg-white border border-neutral-300 text-neutral-900 px-4 py-2 rounded-lg text-[13px] font-medium hover:bg-neutral-50 transition-colors",children:"Cancel"})]})]}),y.length>0?(0,s.jsx)("div",{className:"space-y-3",children:y.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border border-neutral-200 rounded-lg hover:bg-neutral-50 transition-colors",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h5",{className:"text-[14px] font-semibold text-neutral-900",children:e.outlet_name}),(0,s.jsxs)("p",{className:"text-[12px] text-neutral-500 mt-1",children:["Balance: ",(0,s.jsx)("span",{className:"font-semibold text-neutral-900",children:e.credits_balance})," \xb7 Allocation: ",(0,s.jsx)("span",{className:"font-semibold text-neutral-900",children:e.annual_allocation})," \xb7 Auto-renew: ",(0,s.jsx)("span",{className:"font-semibold text-neutral-900",children:e.auto_renew?"Yes":"No"})]})]}),(0,s.jsx)("div",{className:"text-right",children:(0,s.jsxs)("p",{className:"text-[12px] text-neutral-500",children:["Expires ",new Date(e.expires_at).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})]})})]},e.id))}):(0,s.jsx)("p",{className:"text-neutral-500 text-center py-6 text-[13px]",children:"No outlet credits allocated yet"})]})]}),"media"===i.user_type&&(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h4",{className:"text-[13px] font-semibold text-neutral-700",children:"Media Budget"}),(0,s.jsx)("button",{onClick:()=>z(!R),className:"text-[12px] font-medium text-neutral-900 hover:text-neutral-700 transition-colors",children:"Update →"})]}),!R&&(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-[11px] font-semibold uppercase tracking-wide text-neutral-500 mb-1.5 block",children:"Annual Budget"}),(0,s.jsxs)("p",{className:"text-[24px] font-bold text-neutral-900",children:["฿",(i.media_annual_budget||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-[11px] font-semibold uppercase tracking-wide text-neutral-500 mb-1.5 block",children:"Spent"}),(0,s.jsxs)("p",{className:"text-[24px] font-bold text-neutral-900",children:["฿",(i.media_budget_spent||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-[11px] font-semibold uppercase tracking-wide text-neutral-500 mb-1.5 block",children:"Remaining"}),(0,s.jsxs)("p",{className:"text-[24px] font-bold text-neutral-900",children:["฿",((i.media_annual_budget||0)-(i.media_budget_spent||0)).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-[11px] font-semibold uppercase tracking-wide text-neutral-500 mb-1.5 block",children:"Expires At"}),(0,s.jsx)("p",{className:"text-[18px] font-semibold text-neutral-900",children:i.media_budget_expires_at?new Date(i.media_budget_expires_at).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}):"N/A"})]})]}),R&&(0,s.jsxs)("form",{onSubmit:T,className:"space-y-3 bg-neutral-50 p-4 rounded-lg",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-[12px] font-medium text-neutral-700 mb-1",children:"Annual Budget (฿)"}),(0,s.jsx)("input",{type:"number",value:L.annualBudget,onChange:e=>I({...L,annualBudget:e.target.value}),className:"w-full px-3 py-2 text-[13px] border border-neutral-300 rounded-lg focus:ring-2 focus:ring-neutral-900 focus:border-transparent",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-[12px] font-medium text-neutral-700 mb-1",children:"Expires At"}),(0,s.jsx)("input",{type:"date",value:L.expiresAt,onChange:e=>I({...L,expiresAt:e.target.value}),className:"w-full px-3 py-2 text-[13px] border border-neutral-300 rounded-lg focus:ring-2 focus:ring-neutral-900 focus:border-transparent"})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{type:"submit",className:"bg-neutral-900 text-white px-4 py-2 rounded-lg text-[13px] font-medium hover:bg-neutral-800 transition-colors",children:"Update Budget"}),(0,s.jsx)("button",{type:"button",onClick:()=>z(!1),className:"bg-white border border-neutral-300 text-neutral-900 px-4 py-2 rounded-lg text-[13px] font-medium hover:bg-neutral-50 transition-colors",children:"Cancel"})]})]})]})]}),(0,s.jsxs)("div",{className:"bg-white border border-neutral-200 rounded-lg shadow-sm overflow-hidden",children:[(0,s.jsx)("div",{className:"px-6 py-4 border-b border-neutral-200",children:(0,s.jsx)("h3",{className:"text-[14px] font-semibold text-neutral-900",children:"Transaction History"})}),g.length>0?(0,s.jsx)("div",{className:"divide-y divide-neutral-100 max-h-[400px] overflow-y-auto",children:g.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between py-3 px-6 hover:bg-neutral-50 transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ".concat("earn"===e.type?"bg-green-100 text-green-600":"redeem"===e.type?"bg-red-100 text-red-600":"bg-blue-100 text-blue-600"),children:"earn"===e.type?(0,s.jsx)(o.Z,{size:14}):(0,s.jsx)(c,{size:14})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-neutral-900 text-[13px] leading-tight",children:"earn"===e.type?"Points Earned":"redeem"===e.type?e.voucher_name||"Voucher Redeemed":"Manual Adjustment"}),(0,s.jsx)("p",{className:"text-[11px] text-neutral-500 mt-0.5",children:new Date(e.created_at).toLocaleString()}),(e.outlet||e.staff_name)&&(0,s.jsxs)("p",{className:"text-[10px] text-neutral-400 mt-0.5",children:[e.outlet&&e.outlet,e.outlet&&e.staff_name&&" • ",e.staff_name&&"Staff: ".concat(e.staff_name)]})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("p",{className:"text-[15px] font-bold leading-none ".concat(e.points_delta>0?"text-green-600":"text-red-600"),children:[e.points_delta>0?"+":"",e.points_delta.toLocaleString()]}),e.amount_value&&(0,s.jsxs)("p",{className:"text-[10px] text-neutral-500 mt-1",children:["฿",e.amount_value.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]},e.id))}):(0,s.jsxs)("div",{className:"p-12 text-center",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-full bg-neutral-100 flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(b.Z,{size:24,className:"text-neutral-400"})}),(0,s.jsx)("h3",{className:"text-[16px] font-semibold text-neutral-900 mb-1",children:"No transactions yet"}),(0,s.jsx)("p",{className:"text-[14px] text-neutral-500",children:"Transaction history will appear here"})]})]})]})}),(0,s.jsx)(u,{isOpen:k,onClose:()=>A(!1),currentBalance:(null==i?void 0:i.points_balance)||0,userName:i?"".concat(i.name," ").concat(i.surname||"").trim():"",onAdjust:M})]}):null}},4392:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=a(7437);function r(e){let{variant:t="primary",size:a="md",children:r,icon:n,loading:l=!1,className:i="",disabled:d,...o}=e;return(0,s.jsxs)("button",{className:"".concat("inline-flex items-center justify-center font-medium transition-all duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed"," ").concat({primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500 shadow-sm",secondary:"bg-white text-gray-700 border-2 border-gray-300 hover:bg-gray-50 focus:ring-gray-500",tertiary:"bg-transparent text-gray-700 hover:bg-gray-100 focus:ring-gray-500",destructive:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500 shadow-sm"}[t]," ").concat({sm:"px-3 py-1.5 text-sm gap-1.5",md:"px-4 py-2.5 text-sm gap-2",lg:"px-6 py-3 text-base gap-2"}[a]," ").concat(i),disabled:d||l,...o,children:[l&&(0,s.jsxs)("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n&&!l&&n,r]})}},3404:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(7437),r=a(2489),n=a(2265);function l(e){let{isOpen:t,onClose:a,title:l,children:i,size:d="md"}=e;return((0,n.useEffect)(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[t]),t)?(0,s.jsxs)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:a}),(0,s.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"relative bg-white rounded-xl shadow-xl ".concat({sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"}[d]," w-full"),onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:l}),(0,s.jsx)("button",{onClick:a,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:(0,s.jsx)(r.Z,{size:20})})]}),(0,s.jsx)("div",{className:"px-6 py-4",children:i})]})})]}):null}},2660:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8226:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9763).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},3041:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9763).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])}},function(e){e.O(0,[1299,3464,368,5832,2971,2117,1744],function(){return e(e.s=7439)}),_N_E=e.O()}]);