(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3705],{9783:function(e,t,a){Promise.resolve().then(a.bind(a,4690))},4690:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var s=a(7437),l=a(2265),n=a(6189),i=a(9397),c=a(2489),r=a(8420);let m=(0,a(9763).Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);var o=a(5805),d=a(8930),x=a(7689),p=a(9064),u=a(9116);function y(){let[e,t]=(0,l.useState)([]),[a,y]=(0,l.useState)(!0),[h,g]=(0,l.useState)(!1),[b,j]=(0,l.useState)(null),[f,v]=(0,l.useState)(null),[N,_]=(0,l.useState)([]),[k,C]=(0,l.useState)(!1),[w,Z]=(0,l.useState)(!1),[P,E]=(0,l.useState)(""),[S,M]=(0,l.useState)({name:"",slug:"",description:"",discount_percentage:"0",contact_email:"",contact_phone:"",email_domain:"",allow_employee_self_registration:!1,is_active:!0}),[z,D]=(0,l.useState)({employee_email:"",employee_id:"",full_name:"",department:""}),[F,A]=(0,l.useState)("");(0,l.useEffect)(()=>{U()},[]);let U=async()=>{try{let e=await u.ZP.get("/companies",{params:P?{search:P}:{}});t(e.data)}catch(e){p.ZP.error("Failed to load companies")}finally{y(!1)}},q=async e=>{try{let t=await u.ZP.get("/companies/".concat(e,"/employees"));_(t.data)}catch(e){p.ZP.error("Failed to load employees")}},L=async e=>{e.preventDefault();let t=parseInt(S.discount_percentage);if(t<0||t>100){p.ZP.error("Discount must be between 0 and 100");return}try{let e={name:S.name,slug:S.slug||S.name.toLowerCase().replace(/\s+/g,"-"),description:S.description||null,discount_percentage:t,contact_email:S.contact_email||null,contact_phone:S.contact_phone||null,email_domain:S.email_domain||null,allow_employee_self_registration:S.allow_employee_self_registration,is_active:S.is_active};b?(await u.ZP.put("/companies/".concat(b.id),e),p.ZP.success("Company updated successfully")):(await u.ZP.post("/companies",e),p.ZP.success("Company created successfully")),g(!1),j(null),J(),U()}catch(e){var a,s;p.ZP.error((null===(s=e.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.error)||"Failed to save company")}},V=async e=>{if(e.preventDefault(),f)try{let e={employee_email:z.employee_email.toLowerCase(),employee_id:z.employee_id||null,full_name:z.full_name||null,department:z.department||null};await u.ZP.post("/companies/".concat(f.id,"/employees"),e),p.ZP.success("Employee added successfully"),C(!1),O(),q(f.id),U()}catch(e){var t,a;p.ZP.error((null===(a=e.response)||void 0===a?void 0:null===(t=a.data)||void 0===t?void 0:t.error)||"Failed to add employee")}},B=async()=>{if(f)try{let e=F.split("\n").filter(e=>e.trim()).map(e=>{let[t,a,s,l]=e.split(",").map(e=>e.trim());return{employee_email:t.toLowerCase(),employee_id:a||null,full_name:s||null,department:l||null}}),t=await u.ZP.post("/companies/".concat(f.id,"/employees/bulk"),{employees:e});p.ZP.success("Uploaded ".concat(t.data.inserted," employees (").concat(t.data.failed," failed)")),Z(!1),A(""),q(f.id),U()}catch(a){var e,t;p.ZP.error((null===(t=a.response)||void 0===t?void 0:null===(e=t.data)||void 0===e?void 0:e.error)||"Failed to bulk upload")}},H=async e=>{if(f&&confirm("Are you sure you want to remove this employee?"))try{await u.ZP.delete("/companies/".concat(f.id,"/employees/").concat(e)),p.ZP.success("Employee removed"),q(f.id),U()}catch(e){p.ZP.error("Failed to remove employee")}},I=async e=>{if(confirm("Are you sure you want to delete this company? This will also remove all associated employees."))try{await u.ZP.delete("/companies/".concat(e)),p.ZP.success("Company deleted"),U()}catch(e){p.ZP.error("Failed to delete company")}},J=()=>{M({name:"",slug:"",description:"",discount_percentage:"0",contact_email:"",contact_phone:"",email_domain:"",allow_employee_self_registration:!1,is_active:!0})},O=()=>{D({employee_email:"",employee_id:"",full_name:"",department:""})},R=e=>{j(e),M({name:e.name,slug:e.slug,description:e.description||"",discount_percentage:e.discount_percentage.toString(),contact_email:e.contact_email||"",contact_phone:e.contact_phone||"",email_domain:e.email_domain||"",allow_employee_self_registration:e.allow_employee_self_registration,is_active:e.is_active}),g(!0)},T=e=>{v(e),q(e.id)};return(0,s.jsx)(n.Z,{children:(0,s.jsx)("div",{className:"space-y-6",children:f?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{children:[(0,s.jsx)("button",{onClick:()=>{v(null),_([])},className:"text-blue-600 hover:text-blue-800 mb-4 flex items-center gap-2",children:"← Back to Companies"}),(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold text-gray-800",children:[f.name," - Employees"]}),(0,s.jsxs)("p",{className:"text-gray-600",children:[f.discount_percentage,"% discount •"," ",N.length," employees"]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("button",{onClick:()=>Z(!0),className:"btn btn-secondary flex items-center gap-2",children:[(0,s.jsx)(x.Z,{size:20}),"Bulk Upload"]}),(0,s.jsxs)("button",{onClick:()=>C(!0),className:"btn btn-primary flex items-center gap-2",children:[(0,s.jsx)(i.Z,{size:20}),"Add Employee"]})]})]}),k&&(0,s.jsxs)("div",{className:"card bg-blue-50 border border-blue-200 mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-800",children:"Add Employee"}),(0,s.jsx)("button",{onClick:()=>{C(!1),O()},className:"text-gray-500 hover:text-gray-700",children:(0,s.jsx)(c.Z,{size:20})})]}),(0,s.jsxs)("form",{onSubmit:V,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employee Email *"}),(0,s.jsx)("input",{type:"email",className:"input",value:z.employee_email,onChange:e=>D({...z,employee_email:e.target.value}),required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employee ID"}),(0,s.jsx)("input",{type:"text",className:"input",value:z.employee_id,onChange:e=>D({...z,employee_id:e.target.value})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),(0,s.jsx)("input",{type:"text",className:"input",value:z.full_name,onChange:e=>D({...z,full_name:e.target.value})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),(0,s.jsx)("input",{type:"text",className:"input",value:z.department,onChange:e=>D({...z,department:e.target.value})})]})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Add Employee"}),(0,s.jsx)("button",{type:"button",onClick:()=>{C(!1),O()},className:"btn btn-secondary",children:"Cancel"})]})]})]}),w&&(0,s.jsxs)("div",{className:"card bg-yellow-50 border border-yellow-200 mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-800",children:"Bulk Upload Employees"}),(0,s.jsx)("button",{onClick:()=>{Z(!1),A("")},className:"text-gray-500 hover:text-gray-700",children:(0,s.jsx)(c.Z,{size:20})})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:["Enter one employee per line in CSV format:",(0,s.jsx)("br",{}),(0,s.jsx)("code",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:"email, employee_id, full_name, department"})]}),(0,s.jsx)("textarea",{className:"input font-mono text-sm",rows:10,placeholder:"john@company.com, EMP001, John Doe, Engineering jane@company.com, EMP002, Jane Smith, Marketing",value:F,onChange:e=>A(e.target.value)}),(0,s.jsxs)("div",{className:"flex gap-3 mt-4",children:[(0,s.jsx)("button",{onClick:B,className:"btn btn-primary",children:"Upload Employees"}),(0,s.jsx)("button",{onClick:()=>{Z(!1),A("")},className:"btn btn-secondary",children:"Cancel"})]})]}),N.length>0?(0,s.jsx)("div",{className:"card overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-gray-200",children:[(0,s.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-700",children:"Email"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-700",children:"Employee ID"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-700",children:"Full Name"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-700",children:"Department"}),(0,s.jsx)("th",{className:"text-left py-3 px-4 text-sm font-semibold text-gray-700",children:"Status"}),(0,s.jsx)("th",{className:"text-right py-3 px-4 text-sm font-semibold text-gray-700",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:N.map(e=>(0,s.jsxs)("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"py-3 px-4 text-sm text-gray-800",children:e.employee_email}),(0,s.jsx)("td",{className:"py-3 px-4 text-sm text-gray-600",children:e.employee_id||"-"}),(0,s.jsx)("td",{className:"py-3 px-4 text-sm text-gray-600",children:e.full_name||"-"}),(0,s.jsx)("td",{className:"py-3 px-4 text-sm text-gray-600",children:e.department||"-"}),(0,s.jsx)("td",{className:"py-3 px-4",children:e.is_verified?(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700",children:"✓ Verified"}):(0,s.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:"Pending"})}),(0,s.jsx)("td",{className:"py-3 px-4 text-right",children:(0,s.jsx)("button",{onClick:()=>H(e.id),className:"text-red-600 hover:text-red-800 text-sm",children:"Remove"})})]},e.id))})]})}):(0,s.jsxs)("div",{className:"card text-center py-12",children:[(0,s.jsx)(o.Z,{size:48,className:"mx-auto text-gray-300 mb-4"}),(0,s.jsx)("p",{className:"text-gray-500",children:"No employees yet"})]})]})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Companies"}),(0,s.jsxs)("button",{onClick:()=>{j(null),J(),g(!0)},className:"btn btn-primary flex items-center gap-2",children:[(0,s.jsx)(i.Z,{size:20}),"Create Company"]})]}),(0,s.jsx)("div",{children:(0,s.jsx)("input",{type:"text",placeholder:"Search companies...",className:"input max-w-md",value:P,onChange:e=>E(e.target.value),onKeyUp:e=>"Enter"===e.key&&U()})}),h&&(0,s.jsxs)("div",{className:"card bg-blue-50 border border-blue-200",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-800",children:b?"Edit Company":"Create New Company"}),(0,s.jsx)("button",{onClick:()=>{g(!1),j(null),J()},className:"text-gray-500 hover:text-gray-700",children:(0,s.jsx)(c.Z,{size:20})})]}),(0,s.jsxs)("form",{onSubmit:L,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Name *"}),(0,s.jsx)("input",{type:"text",className:"input",value:S.name,onChange:e=>M({...S,name:e.target.value}),required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Slug (URL-friendly name)"}),(0,s.jsx)("input",{type:"text",className:"input",placeholder:"auto-generated if empty",value:S.slug,onChange:e=>M({...S,slug:e.target.value})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,s.jsx)("textarea",{className:"input",rows:3,value:S.description,onChange:e=>M({...S,description:e.target.value})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Discount Percentage (0-100) *"}),(0,s.jsx)("input",{type:"number",min:"0",max:"100",className:"input",value:S.discount_percentage,onChange:e=>M({...S,discount_percentage:e.target.value}),required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Domain (e.g., google.com)"}),(0,s.jsx)("input",{type:"text",className:"input",placeholder:"company.com",value:S.email_domain,onChange:e=>M({...S,email_domain:e.target.value})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Email"}),(0,s.jsx)("input",{type:"email",className:"input",value:S.contact_email,onChange:e=>M({...S,contact_email:e.target.value})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Phone"}),(0,s.jsx)("input",{type:"tel",className:"input",value:S.contact_phone,onChange:e=>M({...S,contact_phone:e.target.value})})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:S.allow_employee_self_registration,onChange:e=>M({...S,allow_employee_self_registration:e.target.checked})}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Allow employee self-registration via email domain"})]}),(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:S.is_active,onChange:e=>M({...S,is_active:e.target.checked})}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Active"})]})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{type:"submit",className:"btn btn-primary",children:b?"Update Company":"Create Company"}),(0,s.jsx)("button",{type:"button",onClick:()=>{g(!1),j(null),J()},className:"btn btn-secondary",children:"Cancel"})]})]})]}),a?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[1,2,3,4].map(e=>(0,s.jsx)("div",{className:"card h-48 bg-gray-100 animate-pulse"},e))}):e.length>0?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map(e=>(0,s.jsx)("div",{className:"card ".concat(e.is_active?"":"opacity-60 bg-gray-50"),children:(0,s.jsxs)("div",{className:"flex items-start gap-4",children:[(0,s.jsx)("div",{className:"w-14 h-14 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:(0,s.jsx)(r.Z,{size:28,className:"text-blue-600"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-800",children:e.name}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:e.slug})]}),(0,s.jsxs)("div",{className:"flex gap-1",children:[(0,s.jsx)("button",{onClick:()=>R(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded",title:"Edit",children:(0,s.jsx)(m,{size:16})}),(0,s.jsx)("button",{onClick:()=>T(e),className:"p-2 text-green-600 hover:bg-green-50 rounded",title:"Manage Employees",children:(0,s.jsx)(o.Z,{size:16})}),(0,s.jsx)("button",{onClick:()=>I(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded",title:"Delete",children:(0,s.jsx)(d.Z,{size:16})})]})]}),e.description&&(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:e.description}),(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,s.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-700",children:[e.discount_percentage,"% discount"]}),(0,s.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-700",children:[e.employee_count," employees"]}),e.email_domain&&(0,s.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-700",children:["@",e.email_domain]}),e.allow_employee_self_registration&&(0,s.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700",children:"Self-registration"}),(0,s.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ".concat(e.is_active?"bg-green-100 text-green-700":"bg-gray-200 text-gray-600"),children:e.is_active?"Active":"Inactive"})]})]})]})},e.id))}):(0,s.jsxs)("div",{className:"card text-center py-12",children:[(0,s.jsx)(r.Z,{size:48,className:"mx-auto text-gray-300 mb-4"}),(0,s.jsx)("p",{className:"text-gray-500",children:"No companies yet"})]})]})})})}},8420:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9763).Z)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},8930:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9763).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},7689:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});let s=(0,a(9763).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])}},function(e){e.O(0,[1299,3464,368,5832,2971,2117,1744],function(){return e(e.s=9783)}),_N_E=e.O()}]);