"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3522],{7209:function(e,t,n){n.d(t,{Z:function(){return p}});var a=n(7437),s=n(9376),r=n(2097),o=n(9637),i=n(5080),c=n(5621),u=n(2369),l=n(7692),d=n(2265);function p(e){let{children:t,hideLogout:n=!1}=e,p=(0,s.useRouter)(),h=(0,s.usePathname)(),{user:g,logout:m}=(0,r.t)(),[f,v]=(0,d.useState)(!1);(0,d.useEffect)(()=>{v(!0)},[]);let y=e=>!!e&&("customer"===e.type||"staff"===e.type||"customer"===e.user_type||"employee"===e.user_type||"staff"===e.user_type);if((0,d.useEffect)(()=>{f&&!y(g)&&p.push("/login")},[g,p,f]),!f)return(0,a.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-6 h-6 border-2 border-black border-t-transparent rounded-full animate-spin"})});if(!y(g))return null;let x=[{icon:o.Z,label:"HOME",path:"/app/home"},{icon:i.Z,label:"VOUCHERS",path:"/app/vouchers"},{icon:c.Z,label:"HISTORY",path:"/app/activity"},{icon:u.Z,label:"PROFILE",path:"/app/profile"}];return(0,a.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,a.jsx)("header",{className:"fixed top-0 left-0 right-0 h-header bg-black z-fixed",children:(0,a.jsxs)("div",{className:"h-full max-w-container mx-auto px-6 flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-label text-white",children:"SARNIES"}),!n&&(0,a.jsx)("button",{onClick:()=>{confirm("Are you sure you want to log out?")&&(m(),p.push("/login"))},className:"p-2.5 -mr-2.5 text-white/60 hover:text-white transition-opacity","aria-label":"Log out",type:"button",children:(0,a.jsx)(l.Z,{className:"w-[18px] h-[18px]",strokeWidth:1.5})})]})}),(0,a.jsx)("main",{className:"pt-header pb-[calc(var(--nav-height)+env(safe-area-inset-bottom,0px)+16px)] min-h-screen",children:(0,a.jsx)("div",{className:"max-w-container mx-auto px-5 py-6",children:t})}),(0,a.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-fixed pb-safe",children:(0,a.jsx)("div",{className:"max-w-container mx-auto px-4",children:(0,a.jsx)("div",{className:"flex justify-around items-start h-[60px] pt-2.5",children:x.map(e=>{let t=e.icon,n=h===e.path||h.startsWith(e.path);return(0,a.jsxs)("button",{onClick:()=>p.push(e.path),className:"flex flex-col items-center justify-start min-w-[64px] py-1 transition-all active:scale-95",children:[(0,a.jsxs)("div",{className:"relative mb-1",children:[(0,a.jsx)(t,{className:"w-[22px] h-[22px] transition-colors ".concat(n?"text-black stroke-[2]":"text-gray-400 stroke-[1.5]")}),n&&(0,a.jsx)("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-1 h-1 rounded-full ".concat((null==g?void 0:g.user_type)==="employee"?"bg-mustard":"bg-accent")})]}),(0,a.jsx)("span",{className:"text-nav ".concat(n?"text-black":"text-gray-400"),children:e.label})]},e.path)})})})})]})}},4728:function(e,t,n){n.d(t,{t:function(){return i}});var a=n(7437),s=n(2265);let r=e=>{let{onRefresh:t,threshold:n=80,resistance:a=2.5}=e,[r,o]=(0,s.useState)(!1),[i,c]=(0,s.useState)(0),[u,l]=(0,s.useState)(!1),d=(0,s.useRef)(0),p=(0,s.useRef)(null);return(0,s.useEffect)(()=>{let e=e=>{0===window.scrollY&&(d.current=e.touches[0].clientY,p.current=e.target)},s=e=>{if(u||window.scrollY>0)return;let t=e.touches[0].clientY-d.current;t>0&&(o(!0),c(Math.min(t/a,1.5*n)),t>10&&e.preventDefault())},h=async()=>{if(r){if(i>=n){l(!0);try{await t()}catch(e){}finally{l(!1)}}o(!1),c(0)}};return document.addEventListener("touchstart",e,{passive:!0}),document.addEventListener("touchmove",s,{passive:!1}),document.addEventListener("touchend",h),()=>{document.removeEventListener("touchstart",e),document.removeEventListener("touchmove",s),document.removeEventListener("touchend",h)}},[r,i,u,t,n,a]),{isPulling:r,pullDistance:i,isRefreshing:u,shouldShowIndicator:r||u}};var o=n(7168);let i=e=>{let{onRefresh:t,children:n}=e,{isPulling:s,pullDistance:i,isRefreshing:c,shouldShowIndicator:u}=r({onRefresh:t});return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"fixed top-0 left-0 right-0 z-40 flex justify-center transition-all duration-200 ".concat(u?"opacity-100":"opacity-0"),style:{transform:"translateY(".concat(Math.min(i,80),"px)")},children:(0,a.jsx)("div",{className:"bg-white rounded-full shadow-lg p-3 mt-4",children:(0,a.jsx)(o.Z,{className:"w-5 h-5 text-gray-700 ".concat(c?"animate-spin":""),style:{transform:c?"":"rotate(".concat(c?360:i/80*180,"deg)"),transition:c?"":"transform 0.1s ease-out"}})})}),n]})}},9347:function(e,t,n){n.d(t,{h:function(){return o}});var a=n(2265),s=n(9376);let r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{onSwipeLeft:t,onSwipeRight:n,threshold:s=50}=e,r=(0,a.useRef)(0),o=(0,a.useRef)(0);(0,a.useEffect)(()=>{let e=e=>{r.current=e.changedTouches[0].screenX},a=e=>{o.current=e.changedTouches[0].screenX,i()},i=()=>{let e=r.current-o.current;Math.abs(e)<s||(e>0?null==t||t():null==n||n())};return document.addEventListener("touchstart",e),document.addEventListener("touchend",a),()=>{document.removeEventListener("touchstart",e),document.removeEventListener("touchend",a)}},[t,n,s])},o=()=>{let e=(0,s.useRouter)(),t=["/app/home","/app/rewards","/app/activity","/app/profile"],n=()=>{let e=window.location.pathname,n=t.findIndex(t=>e.includes(t));return n>=0?n:0},a=a=>{let s;let r=n();(s="left"===a?Math.min(r+1,t.length-1):Math.max(r-1,0))!==r&&e.push(t[s])};r({onSwipeLeft:()=>a("left"),onSwipeRight:()=>a("right"),threshold:75})}},9116:function(e,t,n){n.d(t,{L2:function(){return i},Vj:function(){return u},Z1:function(){return h},cC:function(){return p},h3:function(){return r},hO:function(){return o},kv:function(){return s},nN:function(){return l},oZ:function(){return c},w2:function(){return d},xf:function(){return g}});let a=n(3464).Z.create({baseURL:"https://loyalty.sarnies.tech/api",headers:{"Content-Type":"application/json"},withCredentials:!0});a.interceptors.request.use(e=>{{let t=localStorage.getItem("auth-storage");if(t)try{let{state:n}=JSON.parse(t);(null==n?void 0:n.token)&&(e.headers.Authorization="Bearer ".concat(n.token))}catch(e){}}return e}),a.interceptors.response.use(e=>e,e=>{var t,n,a;if((null===(t=e.response)||void 0===t?void 0:t.status)===401){let t=window.location.pathname.includes("/login"),s=null===(a=e.config)||void 0===a?void 0:null===(n=a.url)||void 0===n?void 0:n.includes("/auth/"),r=localStorage.getItem("auth-storage");t||s||!r||(localStorage.removeItem("auth-storage"),window.location.href="/login")}return Promise.reject(e)}),t.ZP=a;let s={staffLogin:(e,t)=>a.post("/auth/login",{email:e,password:t}),sendOTP:e=>a.post("/auth/otp/send",{phone:e}),verifyOTP:(e,t)=>a.post("/auth/otp/verify",{phone:e,otp:t}),sendEmailOTP:e=>a.post("/auth/otp/email/send",{email:e}),verifyEmailOTP:(e,t)=>a.post("/auth/otp/email/verify",{email:e,otp:t}),sendMagicLink:e=>a.post("/auth/magic-link/send",{email:e}),verifyMagicLink:e=>a.get("/auth/magic-link/verify/".concat(e))},r={getAll:e=>a.get("/users",{params:e}),getOne:e=>a.get("/users/".concat(e)),update:(e,t)=>a.put("/users/".concat(e),t),adjustPoints:(e,t,n)=>a.post("/users/".concat(e,"/points"),{points:t,reason:n}),getStaticQR:e=>a.get("/users/".concat(e,"/static-qr")),getVoucherInstances:(e,t)=>a.get("/users/".concat(e,"/voucher-instances"),{params:t?{status:t}:void 0})},o={getAll:()=>a.get("/vouchers"),getAllAdmin:()=>a.get("/vouchers/all"),getOne:e=>a.get("/vouchers/".concat(e)),create:e=>a.post("/vouchers",e),update:(e,t)=>a.patch("/vouchers/".concat(e),t),delete:e=>a.delete("/vouchers/".concat(e)),redeem:(e,t)=>a.post("/vouchers/".concat(e,"/redeem"),{user_id:t}),getInstances:(e,t)=>a.get("/vouchers/instances/".concat(e),{params:{status:t}})},i={earnPoints:(e,t,n)=>a.post("/transactions/earn",{user_id:e,amount:t,outlet:n}),redeemVoucher:(e,t,n)=>a.post("/transactions/redeem",{user_id:e,voucher_id:t,outlet:n}),getAll:e=>a.get("/transactions",{params:e})},c={getAll:e=>a.get("/announcements",{params:{user_type:e}}),getAllAdmin:()=>a.get("/announcements/all"),getById:e=>a.get("/announcements/".concat(e)),create:e=>a.post("/announcements",e),update:(e,t)=>a.patch("/announcements/".concat(e),t),delete:e=>a.delete("/announcements/".concat(e))},u={getCredits:()=>a.get("/investors/credits"),getOutletCredits:e=>a.get("/investors/credits/outlet/".concat(e)),getTransactions:e=>a.get("/investors/transactions",{params:e}),allocateOutletCredits:(e,t)=>a.post("/investors/admin/".concat(e,"/outlet-credits"),t),allocateGroupCredits:(e,t)=>a.post("/investors/admin/".concat(e,"/group-credits"),t),adjustCredits:(e,t)=>a.patch("/investors/admin/".concat(e,"/credits/adjust"),t),getExpiringCredits:e=>a.get("/investors/admin/credits/expiring",{params:e?{days:e}:void 0})},l={getBudget:()=>a.get("/media/budget"),getTransactions:e=>a.get("/media/transactions",{params:e}),setBudget:(e,t)=>a.post("/media/admin/".concat(e,"/budget"),t),adjustBudget:(e,t)=>a.patch("/media/admin/".concat(e,"/budget/adjust"),t),getExpiringBudgets:e=>a.get("/media/admin/budgets/expiring",{params:e?{days:e}:void 0}),getUsageReport:()=>a.get("/media/admin/usage-report")},d={getAll:()=>a.get("/settings"),getOne:e=>a.get("/settings/".concat(e)),update:(e,t)=>a.put("/settings/".concat(e),{value:t}),bulkUpdate:e=>a.put("/settings",{settings:e}),create:e=>a.post("/settings",e)},p={getVapidKey:()=>a.get("/notifications/vapid-public-key"),subscribe:e=>a.post("/notifications/subscribe",{subscription:e.toJSON()}),unsubscribe:e=>a.post("/notifications/unsubscribe",{endpoint:e}),getStatus:()=>a.get("/notifications/status"),getPreferences:()=>a.get("/notifications/preferences"),updatePreferences:e=>a.patch("/notifications/preferences",{preferences:e}),sendTest:()=>a.post("/notifications/test"),getHistory:e=>a.get("/notifications/history",{params:e}),adminSend:e=>a.post("/notifications/admin/send",e),adminBroadcast:e=>a.post("/notifications/admin/broadcast",e),adminStats:()=>a.get("/notifications/admin/stats"),adminProcessQueue:()=>a.post("/notifications/admin/process-queue")},h={getMyCode:()=>a.get("/referrals/my-code"),getMyReferrals:()=>a.get("/referrals/my-referrals"),validateCode:e=>a.get("/referrals/validate/".concat(e)),applyCode:e=>a.post("/referrals/apply",e),getAdminStats:()=>a.get("/referrals/admin/stats")},g={getAll:()=>a.get("/pos/keys"),create:e=>a.post("/pos/keys",e),revoke:e=>a.delete("/pos/keys/".concat(e)),getLogs:(e,t)=>a.get("/pos/keys/".concat(e,"/logs"),{params:t}),getStats:()=>a.get("/pos/keys/stats")}},2097:function(e,t,n){n.d(t,{t:function(){return r}});var a=n(9625),s=n(6885);let r=(0,a.Ue)()((0,s.tJ)(e=>({user:null,token:null,hasHydrated:!1,setAuth:(t,n)=>{e({user:t,token:n})},logout:()=>{e({user:null,token:null})},updateUser:t=>{e(e=>e.user?{user:{...e.user,...t}}:e)},setHasHydrated:t=>{e({hasHydrated:t})}}),{name:"auth-storage",storage:(0,s.FL)(()=>localStorage),onRehydrateStorage:()=>e=>{null==e||e.setHasHydrated(!0)}}))},407:function(e,t,n){n.d(t,{Z:function(){return a}});let a=(0,n(9763).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},1197:function(e,t,n){n.d(t,{Z:function(){return a}});let a=(0,n(9763).Z)("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]])},7414:function(e,t,n){n.d(t,{Z:function(){return a}});let a=(0,n(9763).Z)("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]])},7168:function(e,t,n){n.d(t,{Z:function(){return a}});let a=(0,n(9763).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}}]);