"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2336],{7209:function(e,t,s){s.d(t,{Z:function(){return p}});var a=s(7437),n=s(9376),r=s(2097),i=s(9637),o=s(5080),c=s(5621),l=s(2369),d=s(7692),u=s(2265);function p(e){let{children:t,hideLogout:s=!1}=e,p=(0,n.useRouter)(),m=(0,n.usePathname)(),{user:g,logout:h}=(0,r.t)(),[x,f]=(0,u.useState)(!1);(0,u.useEffect)(()=>{f(!0)},[]);let b=e=>!!e&&("customer"===e.type||"staff"===e.type||"customer"===e.user_type||"employee"===e.user_type||"staff"===e.user_type);if((0,u.useEffect)(()=>{x&&!b(g)&&p.push("/login")},[g,p,x]),!x)return(0,a.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-6 h-6 border-2 border-black border-t-transparent rounded-full animate-spin"})});if(!b(g))return null;let v=[{icon:i.Z,label:"HOME",path:"/app/home"},{icon:o.Z,label:"VOUCHERS",path:"/app/vouchers"},{icon:c.Z,label:"HISTORY",path:"/app/activity"},{icon:l.Z,label:"PROFILE",path:"/app/profile"}];return(0,a.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,a.jsx)("header",{className:"fixed top-0 left-0 right-0 h-header bg-black z-fixed",children:(0,a.jsxs)("div",{className:"h-full max-w-container mx-auto px-6 flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-label text-white",children:"SARNIES"}),!s&&(0,a.jsx)("button",{onClick:()=>{confirm("Are you sure you want to log out?")&&(h(),p.push("/login"))},className:"p-2.5 -mr-2.5 text-white/60 hover:text-white transition-opacity","aria-label":"Log out",type:"button",children:(0,a.jsx)(d.Z,{className:"w-[18px] h-[18px]",strokeWidth:1.5})})]})}),(0,a.jsx)("main",{className:"pt-header pb-[calc(var(--nav-height)+env(safe-area-inset-bottom,0px)+16px)] min-h-screen",children:(0,a.jsx)("div",{className:"max-w-container mx-auto px-5 py-6",children:t})}),(0,a.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-fixed pb-safe",children:(0,a.jsx)("div",{className:"max-w-container mx-auto px-4",children:(0,a.jsx)("div",{className:"flex justify-around items-start h-[60px] pt-2.5",children:v.map(e=>{let t=e.icon,s=m===e.path||m.startsWith(e.path);return(0,a.jsxs)("button",{onClick:()=>p.push(e.path),className:"flex flex-col items-center justify-start min-w-[64px] py-1 transition-all active:scale-95",children:[(0,a.jsxs)("div",{className:"relative mb-1",children:[(0,a.jsx)(t,{className:"w-[22px] h-[22px] transition-colors ".concat(s?"text-black stroke-[2]":"text-gray-400 stroke-[1.5]")}),s&&(0,a.jsx)("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-1 h-1 rounded-full ".concat((null==g?void 0:g.user_type)==="employee"?"bg-mustard":"bg-accent")})]}),(0,a.jsx)("span",{className:"text-nav ".concat(s?"text-black":"text-gray-400"),children:e.label})]},e.path)})})})})]})}},978:function(e,t,s){s.d(t,{Z:function(){return i}});var a=s(7437),n=s(2265),r=s(2489);function i(e){let{isOpen:t,onClose:s,title:i,qrDataUrl:o,expiresAt:c,description:l,loading:d=!1}=e,[u,p]=(0,n.useState)(null);return((0,n.useEffect)(()=>{if(!c)return;let e=()=>{let e=new Date().getTime(),t=Math.max(0,Math.floor((new Date(c).getTime()-e)/1e3));p(t),0===t&&setTimeout(()=>{s()},2e3)};e();let t=setInterval(e,1e3);return()=>clearInterval(t)},[c,s]),t)?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl max-w-md w-full p-6 relative",children:[(0,a.jsx)("button",{onClick:s,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",children:(0,a.jsx)(r.Z,{className:"w-6 h-6"})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-black mb-2 pr-8",children:i}),l&&(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-6",children:l}),(0,a.jsx)("div",{className:"flex justify-center mb-6 bg-white p-4 rounded-lg",children:d?(0,a.jsx)("div",{className:"w-[320px] h-[320px] flex items-center justify-center",children:(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-black border-t-transparent rounded-full animate-spin"})}):o?(0,a.jsx)("img",{src:o,alt:"QR Code",className:"w-[320px] h-[320px]",style:{imageRendering:"crisp-edges"}}):(0,a.jsx)("div",{className:"w-[320px] h-[320px] flex items-center justify-center bg-gray-100 rounded-lg",children:(0,a.jsxs)("div",{className:"text-center px-6",children:[(0,a.jsx)("p",{className:"text-gray-600 font-medium mb-2",children:"QR Code Unavailable"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Please try closing and reopening, or contact support"})]})})}),null!==u&&(0,a.jsx)("div",{className:"text-center mb-4",children:u>0?(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Expires in"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-black",children:"".concat(Math.floor(u/60),":").concat((u%60).toString().padStart(2,"0"))})]}):(0,a.jsx)("p",{className:"text-lg font-semibold text-red-600",children:"QR Code Expired"})}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[(0,a.jsx)("p",{className:"text-center text-sm font-semibold text-blue-900 mb-2",children:"Show this QR code to staff at checkout"}),(0,a.jsxs)("div",{className:"text-xs text-blue-800 space-y-1",children:[(0,a.jsx)("p",{children:"\uD83D\uDCA1 Turn screen brightness to 100%"}),(0,a.jsx)("p",{children:"\uD83D\uDCCF Hold device 15-20cm from scanner camera"}),(0,a.jsx)("p",{children:"\uD83D\uDCF1 Keep screen flat and steady"}),(0,a.jsx)("p",{children:"\uD83D\uDDA5ï¸ Scanning from computer screen? Tilt screen to avoid glare"})]})]}),(0,a.jsx)("button",{onClick:s,className:"w-full bg-black text-white py-3 rounded-md font-medium hover:bg-gray-800 transition-colors",children:"Done"})]})}):null}},9116:function(e,t,s){s.d(t,{L2:function(){return o},Vj:function(){return l},Z1:function(){return m},cC:function(){return p},h3:function(){return r},hO:function(){return i},kv:function(){return n},nN:function(){return d},oZ:function(){return c},w2:function(){return u},xf:function(){return g}});let a=s(3464).Z.create({baseURL:"https://loyalty.sarnies.tech/api",headers:{"Content-Type":"application/json"},withCredentials:!0});a.interceptors.request.use(e=>{{let t=localStorage.getItem("auth-storage");if(t)try{let{state:s}=JSON.parse(t);(null==s?void 0:s.token)&&(e.headers.Authorization="Bearer ".concat(s.token))}catch(e){}}return e}),a.interceptors.response.use(e=>e,e=>{var t,s,a;if((null===(t=e.response)||void 0===t?void 0:t.status)===401){let t=window.location.pathname.includes("/login"),n=null===(a=e.config)||void 0===a?void 0:null===(s=a.url)||void 0===s?void 0:s.includes("/auth/"),r=localStorage.getItem("auth-storage");t||n||!r||(localStorage.removeItem("auth-storage"),window.location.href="/login")}return Promise.reject(e)}),t.ZP=a;let n={staffLogin:(e,t)=>a.post("/auth/login",{email:e,password:t}),sendOTP:e=>a.post("/auth/otp/send",{phone:e}),verifyOTP:(e,t)=>a.post("/auth/otp/verify",{phone:e,otp:t}),sendEmailOTP:e=>a.post("/auth/otp/email/send",{email:e}),verifyEmailOTP:(e,t)=>a.post("/auth/otp/email/verify",{email:e,otp:t}),sendMagicLink:e=>a.post("/auth/magic-link/send",{email:e}),verifyMagicLink:e=>a.get("/auth/magic-link/verify/".concat(e))},r={getAll:e=>a.get("/users",{params:e}),getOne:e=>a.get("/users/".concat(e)),update:(e,t)=>a.put("/users/".concat(e),t),adjustPoints:(e,t,s)=>a.post("/users/".concat(e,"/points"),{points:t,reason:s}),getStaticQR:e=>a.get("/users/".concat(e,"/static-qr")),getVoucherInstances:(e,t)=>a.get("/users/".concat(e,"/voucher-instances"),{params:t?{status:t}:void 0})},i={getAll:()=>a.get("/vouchers"),getAllAdmin:()=>a.get("/vouchers/all"),getOne:e=>a.get("/vouchers/".concat(e)),create:e=>a.post("/vouchers",e),update:(e,t)=>a.patch("/vouchers/".concat(e),t),delete:e=>a.delete("/vouchers/".concat(e)),redeem:(e,t)=>a.post("/vouchers/".concat(e,"/redeem"),{user_id:t}),getInstances:(e,t)=>a.get("/vouchers/instances/".concat(e),{params:{status:t}})},o={earnPoints:(e,t,s)=>a.post("/transactions/earn",{user_id:e,amount:t,outlet:s}),redeemVoucher:(e,t,s)=>a.post("/transactions/redeem",{user_id:e,voucher_id:t,outlet:s}),getAll:e=>a.get("/transactions",{params:e})},c={getAll:e=>a.get("/announcements",{params:{user_type:e}}),getAllAdmin:()=>a.get("/announcements/all"),getById:e=>a.get("/announcements/".concat(e)),create:e=>a.post("/announcements",e),update:(e,t)=>a.patch("/announcements/".concat(e),t),delete:e=>a.delete("/announcements/".concat(e))},l={getCredits:()=>a.get("/investors/credits"),getOutletCredits:e=>a.get("/investors/credits/outlet/".concat(e)),getTransactions:e=>a.get("/investors/transactions",{params:e}),allocateOutletCredits:(e,t)=>a.post("/investors/admin/".concat(e,"/outlet-credits"),t),allocateGroupCredits:(e,t)=>a.post("/investors/admin/".concat(e,"/group-credits"),t),adjustCredits:(e,t)=>a.patch("/investors/admin/".concat(e,"/credits/adjust"),t),getExpiringCredits:e=>a.get("/investors/admin/credits/expiring",{params:e?{days:e}:void 0})},d={getBudget:()=>a.get("/media/budget"),getTransactions:e=>a.get("/media/transactions",{params:e}),setBudget:(e,t)=>a.post("/media/admin/".concat(e,"/budget"),t),adjustBudget:(e,t)=>a.patch("/media/admin/".concat(e,"/budget/adjust"),t),getExpiringBudgets:e=>a.get("/media/admin/budgets/expiring",{params:e?{days:e}:void 0}),getUsageReport:()=>a.get("/media/admin/usage-report")},u={getAll:()=>a.get("/settings"),getOne:e=>a.get("/settings/".concat(e)),update:(e,t)=>a.put("/settings/".concat(e),{value:t}),bulkUpdate:e=>a.put("/settings",{settings:e}),create:e=>a.post("/settings",e)},p={getVapidKey:()=>a.get("/notifications/vapid-public-key"),subscribe:e=>a.post("/notifications/subscribe",{subscription:e.toJSON()}),unsubscribe:e=>a.post("/notifications/unsubscribe",{endpoint:e}),getStatus:()=>a.get("/notifications/status"),getPreferences:()=>a.get("/notifications/preferences"),updatePreferences:e=>a.patch("/notifications/preferences",{preferences:e}),sendTest:()=>a.post("/notifications/test"),getHistory:e=>a.get("/notifications/history",{params:e}),adminSend:e=>a.post("/notifications/admin/send",e),adminBroadcast:e=>a.post("/notifications/admin/broadcast",e),adminStats:()=>a.get("/notifications/admin/stats"),adminProcessQueue:()=>a.post("/notifications/admin/process-queue")},m={getMyCode:()=>a.get("/referrals/my-code"),getMyReferrals:()=>a.get("/referrals/my-referrals"),validateCode:e=>a.get("/referrals/validate/".concat(e)),applyCode:e=>a.post("/referrals/apply",e),getAdminStats:()=>a.get("/referrals/admin/stats")},g={getAll:()=>a.get("/pos/keys"),create:e=>a.post("/pos/keys",e),revoke:e=>a.delete("/pos/keys/".concat(e)),getLogs:(e,t)=>a.get("/pos/keys/".concat(e,"/logs"),{params:t}),getStats:()=>a.get("/pos/keys/stats")}},2097:function(e,t,s){s.d(t,{t:function(){return r}});var a=s(9625),n=s(6885);let r=(0,a.Ue)()((0,n.tJ)(e=>({user:null,token:null,hasHydrated:!1,setAuth:(t,s)=>{e({user:t,token:s})},logout:()=>{e({user:null,token:null})},updateUser:t=>{e(e=>e.user?{user:{...e.user,...t}}:e)},setHasHydrated:t=>{e({hasHydrated:t})}}),{name:"auth-storage",storage:(0,n.FL)(()=>localStorage),onRehydrateStorage:()=>e=>{null==e||e.setHasHydrated(!0)}}))},1723:function(e,t,s){s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},2489:function(e,t,s){s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])}}]);